<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ujian Online Bahasa Inggris PERGUNU Situbondo</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --color-primary: #6a11cb;
            --color-secondary: #2575fc;
            --color-tertiary: #00c6fb;
            --color-success: #4CAF50;
            --color-error: #f44336;
            --color-warning: #ff9800;
            --color-info: #2196F3;
            --color-dark: #1a1a2e;
            --color-light: #f8f9fa;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background: linear-gradient(135deg, var(--color-primary), var(--color-secondary), var(--color-tertiary));
            color: white;
            min-height: 100vh;
            overflow-x: hidden;
            position: relative;
        }

        /* Particle Background */
        #particles-js {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
        }

        #celebration-particles {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 1000;
            pointer-events: none;
            display: none;
        }

        .container {
            position: relative;
            z-index: 1;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 30px;
        }

        .logo {
            height: 80px;
            margin-bottom: 15px;
        }

        /* Card Styles */
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            margin-bottom: 30px;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 12px 25px;
            border-radius: 50px;
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            color: white;
            text-decoration: none;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
            margin: 5px;
            text-align: center;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(37, 117, 252, 0.4);
        }

        .btn:active {
            transform: translateY(1px);
        }

        .btn-success {
            background: linear-gradient(to right, var(--color-success), #2ecc71);
        }

        .btn-danger {
            background: linear-gradient(to right, var(--color-error), #e74c3c);
        }

        .btn-warning {
            background: linear-gradient(to right, var(--color-warning), #f39c12);
        }

        .btn-info {
            background: linear-gradient(to right, var(--color-info), #3498db);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 20px;
            position: relative;
        }

        .form-control {
            width: 100%;
            padding: 12px 15px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.3);
            background: rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--color-secondary);
            background: rgba(255, 255, 255, 0.2);
            box-shadow: 0 0 0 3px rgba(37, 117, 252, 0.2);
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        /* Radio and Checkbox Styles */
        .radio-group, .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .radio-option, .checkbox-option {
            display: none;
        }

        .radio-label, .checkbox-label {
            padding: 10px 20px;
            border-radius: 50px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-option:checked + .radio-label,
        .checkbox-option:checked + .checkbox-label {
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
        }

        /* Custom Checkbox for Terms */
        .terms-checkbox-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .terms-checkbox {
            width: 20px;
            height: 20px;
            margin-right: 10px;
            accent-color: var(--color-secondary);
        }
        
        .terms-text {
            font-size: 14px;
        }

        /* Animation Classes */
        .slide-in {
            animation: slideIn 0.5s forwards;
        }

        .slide-out {
            animation: slideOut 0.5s forwards;
        }

        .fade-in {
            animation: fadeIn 0.5s forwards;
        }

        .fade-out {
            animation: fadeOut 0.5s forwards;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(-100%); opacity: 0; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeOut {
            from { opacity: 1; }
            to { opacity: 0; }
        }

        /* Timer Styles */
        .timer {
            font-size: 24px;
            font-weight: 700;
            text-align: center;
            margin: 20px 0;
            color: white;
            transition: all 0.3s ease;
        }

        .timer-warning {
            color: var(--color-warning);
            font-size: 28px;
        }

        .timer-danger {
            color: var(--color-error);
            font-size: 32px;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Notification Styles */
        .notification {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1000;
            animation: slideUp 0.5s forwards;
            max-width: 90%;
            text-align: center;
        }

        @keyframes slideUp {
            from { bottom: -50px; opacity: 0; }
            to { bottom: 20px; opacity: 1; }
        }

        /* Question Styles */
        .question-container {
            margin-bottom: 30px;
        }

        .question {
            font-size: 18px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options {
            display: grid;
            grid-template-columns: 1fr;
            gap: 10px;
        }

        .option {
            padding: 15px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .option:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .option.correct {
            background: var(--color-success);
            animation: correctAnswer 0.5s;
        }

        .option.incorrect {
            background: var(--color-error);
            animation: incorrectAnswer 0.5s;
        }

        @keyframes correctAnswer {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes incorrectAnswer {
            0% { transform: translateX(0); }
            20% { transform: translateX(-10px); }
            40% { transform: translateX(10px); }
            60% { transform: translateX(-10px); }
            80% { transform: translateX(10px); }
            100% { transform: translateX(0); }
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
            display: none;
        }

        /* Certificate Styles - REVISED FOR PRINTING */
        .certificate {
            background: white;
            color: #333;
            padding: 0;
            border-radius: 0;
            box-shadow: none;
            width: 210mm; /* A4 width */
            height: 297mm; /* A4 height */
            margin: 20px auto;
            position: relative;
            overflow: hidden;
            background-image: url('https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/certificate.png');
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
            display: flex;
            flex-direction: column;
            justify-content: center;
            page-break-after: avoid;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .certificate-content {
            position: relative;
            z-index: 1;
            text-align: center;
            padding: 40px 60px;
            margin: 0 auto;
            width: 80%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .certificate-title {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            color: var(--color-primary);
            text-transform: uppercase;
        }

        .certificate-code {
            font-size: 14px;
            margin-bottom: 30px;
            color: #555;
            letter-spacing: 1px;
        }

        .certificate-recipient {
            font-size: 48px;
            margin: 20px 0;
            font-weight: 600;
            color: #333;
            font-family: 'Dancing Script', cursive;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        .certificate-body {
            font-size: 16px;
            line-height: 1.6;
            margin: 10px 0;
            color: #333;
        }

        .certificate-score {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-primary);
            margin: 20px 0;
        }

        .certificate-motivation {
            font-style: italic;
            margin: 15px 0;
            font-size: 14px;
            color: #555;
        }

        .certificate-footer {
            margin-top: 30px;
            font-size: 12px;
            color: #555;
        }

        .certificate-signature {
            margin-top: 40px;
            font-size: 14px;
        }

        .certificate-barcode {
            margin: 15px auto;
            height: 80px;
            width: auto;
        }

        /* Floating Button Styles */
        .floating-buttons {
            position: fixed;
            bottom: 30px;
            right: 30px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            z-index: 100;
        }

        .floating-btn {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: linear-gradient(to right, var(--color-secondary), var(--color-tertiary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .floating-btn:hover {
            transform: translateY(-5px) scale(1.1);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.4);
        }

        .floating-btn .tooltip {
            position: absolute;
            right: 60px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 14px;
            opacity: 0;
            pointer-events: none;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .floating-btn:hover .tooltip {
            opacity: 1;
            right: 70px;
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: modalFadeIn 0.3s;
        }

        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: var(--color-primary);
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Roman numeral styles */
        .roman {
            font-family: 'Times New Roman', serif;
            font-style: italic;
        }

        /* Print Styles - REVISED FOR BETTER PRINTING */
        @media print {
            body * {
                visibility: hidden;
                background: white !important;
                color: black !important;
            }
            
            .certificate, 
            .certificate * {
                visibility: visible;
                background: transparent !important;
                color: #333 !important;
            }
            
            .certificate {
                position: absolute;
                left: 0;
                top: 0;
                width: 210mm !important;
                height: 297mm !important;
                margin: 0 !important;
                padding: 0 !important;
                box-shadow: none !important;
                border-radius: 0 !important;
                background-image: url('https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/certificate.png') !important;
                background-size: cover !important;
                background-position: center !important;
                background-repeat: no-repeat !important;
                -webkit-print-color-adjust: exact !important;
                print-color-adjust: exact !important;
                page-break-after: avoid !important;
                page-break-inside: avoid !important;
            }
            
            .certificate-content {
                padding: 40px 60px !important;
                margin: 0 auto !important;
                width: 80% !important;
                height: 100% !important;
                display: flex !important;
                flex-direction: column !important;
                justify-content: center !important;
            }
            
            .certificate-recipient {
                font-size: 48px !important;
                font-family: 'Dancing Script', cursive !important;
            }
            
            .floating-buttons, 
            .results-summary, 
            .result-actions {
                display: none !important;
            }
            
            @page {
                size: A4 portrait;
                margin: 0;
            }
        }

        /* Responsive Styles */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .card {
                padding: 20px;
            }
            
            .certificate-content {
                padding: 30px;
                width: 90%;
            }
            
            .certificate-title {
                font-size: 24px;
            }
            
            .certificate-recipient {
                font-size: 36px;
            }
            
            .floating-buttons {
                bottom: 20px;
                right: 20px;
            }
            
            .floating-btn {
                width: 45px;
                height: 45px;
                font-size: 18px;
            }

            .modal-content {
                width: 95%;
                padding: 20px;
            }
        }

        @media (max-width: 480px) {
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .form-control {
                padding: 10px 12px;
                font-size: 14px;
            }
            
            .certificate-content {
                padding: 20px;
                width: 95%;
            }
            
            .certificate-title {
                font-size: 20px;
            }
            
            .certificate-recipient {
                font-size: 28px;
            }
        }

        /* Admin Panel Specific Styles */
        .admin-section {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }

        .admin-section h5 {
            color: var(--color-primary);
            margin-bottom: 15px;
            font-size: 18px;
        }

        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        .admin-control-group {
            margin-bottom: 15px;
        }

        .admin-control-label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            font-size: 14px;
        }

        .admin-control-input {
            width: 100%;
            padding: 10px 12px;
            border-radius: 6px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        .admin-toggle {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .toggle-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .toggle-slider {
            background-color: var(--color-success);
        }

        input:checked + .toggle-slider:before {
            transform: translateX(26px);
        }

        .participant-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 15px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 10px;
        }

        .participant-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            font-size: 14px;
        }

        .participant-item:last-child {
            border-bottom: none;
        }

        .export-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
            font-size: 14px;
        }

        .data-table th, .data-table td {
            padding: 10px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        .data-table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }

        .data-table tr:hover {
            background-color: #f9f9f9;
        }

        /* Checkbox styles for participant selection */
        .select-checkbox {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .select-all-checkbox {
            margin-right: 5px;
        }

        .participant-actions {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        /* Search Box */
        .search-box {
            margin-bottom: 15px;
        }

        .search-input {
            width: 100%;
            padding: 10px 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
            font-size: 14px;
        }

        /* Edit Participant Modal */
        .edit-participant-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .edit-participant-content {
            background: white;
            color: #333;
            border-radius: 15px;
            padding: 30px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .edit-participant-close {
            position: absolute;
            top: 15px;
            right: 15px;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        /* Certificate Validation Section */
        .certificate-validation {
            margin-top: 20px;
            padding: 15px;
            background-color: #f5f5f5;
            border-radius: 8px;
        }

        .validation-result {
            margin-top: 10px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }

        .valid-certificate {
            background-color: #dff0d8;
            color: #3c763d;
        }

        .invalid-certificate {
            background-color: #f2dede;
            color: #a94442;
        }

        /* Alert Styles */
        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-size: 14px;
        }

        .alert-success {
            background-color: #dff0d8;
            color: #3c763d;
            border: 1px solid #d6e9c6;
        }

        .alert-danger {
            background-color: #f2dede;
            color: #a94442;
            border: 1px solid #ebccd1);
        }

        /* Error message styles */
        .error-message {
            color: var(--color-error);
            font-size: 12px;
            margin-top: 5px;
            display: none;
        }

        /* Warning notification */
        .warning-notification {
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--color-warning);
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            z-index: 1000;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            display: none;
            animation: fadeIn 0.3s;
        }

        /* Input error state */
        .input-error {
            border-color: var(--color-error) !important;
            background: rgba(244, 67, 54, 0.1) !important;
        }

        /* Radio group error */
        .radio-group-error {
            outline: 2px solid var(--color-error);
            border-radius: 8px;
            padding: 5px;
        }
    </style>
</head>
<body>
    <div id="particles-js"></div>
    <div id="celebration-particles"></div>
    
    <!-- Warning notification for incomplete form -->
    <div class="warning-notification" id="form-warning">
        <i class="fas fa-exclamation-circle"></i> Harap lengkapi semua data peserta dengan benar sebelum melanjutkan!
    </div>
    
    <div class="container">
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="card slide-in">
            <div class="header">
                <img src="https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/logo.png" alt="PERGUNU Logo" class="logo">
                <h1>Ujian Online Bahasa Inggris PERGUNU Situbondo</h1>
            </div>
            
            <div id="greeting-message">
                <p id="greeting-text">Selamat datang di sistem ujian online Bahasa Inggris PERGUNU Situbondo. Silakan masukkan kode login untuk melanjutkan.</p>
            </div>
            
            <div class="form-group">
                <label for="login-code" class="form-label">Kode Login</label>
                <input type="password" id="login-code" class="form-control" placeholder="Masukkan kode login">
                <small class="text-muted">Kode login diberikan oleh admin</small>
            </div>
            
            <button id="login-btn" class="btn">Masuk</button>
        </div>
        
        <!-- Terms Screen (Hidden Initially) -->
        <div id="terms-screen" class="card" style="display: none;">
            <h2>Peraturan dan Kebijakan Ujian Online</h2>
            <div class="terms-content" style="max-height: 300px; overflow-y: auto; margin: 20px 0; padding: 15px; background: rgba(0, 0, 0, 0.1); border-radius: 8px;">
                <p>1. Ujian ini dikembangkan oleh Cendhanu Tim Kreator PERGUNU Situbondo.</p>
                <p>2. Peserta wajib mengisi data diri dengan benar dan lengkap.</p>
                <p>3. Dilarang keras melakukan kecurangan selama ujian berlangsung.</p>
                <p>4. Waktu ujian akan berjalan terus dan tidak dapat dihentikan.</p>
                <p>5. Jawaban yang sudah dipilih tidak dapat diubah.</p>
                <p>6. Soal yang tidak dijawab akan dianggap salah.</p>
                <p>7. Hasil ujian akan ditampilkan setelah waktu habis atau peserta menyelesaikan ujian.</p>
                <p>8. Sertifikat akan diberikan kepada peserta yang menyelesaikan ujian.</p>
                <p>9. Keputusan panitia ujian bersifat mutlak dan tidak dapat diganggu gugat.</p>
            </div>
            
            <div class="terms-checkbox-container">
                <input type="checkbox" id="agree-terms" class="terms-checkbox" required>
                <span class="terms-text">Saya telah membaca dan menyetujui peraturan di atas</span>
            </div>
            
            <button id="continue-btn" class="btn" disabled>Lanjut Ikut Ujian</button>
        </div>
        
        <!-- Participant Form (Hidden Initially) -->
        <div id="participant-form" class="card" style="display: none;">
            <h2>Formulir Data Peserta</h2>
            <p>Silakan isi data diri Anda dengan benar. Data ini akan digunakan untuk sertifikat ujian.</p>
            
            <div class="form-group">
                <label for="fullname" class="form-label">Nama Lengkap</label>
                <input type="text" id="fullname" class="form-control" placeholder="Masukkan nama lengkap" pattern="[A-Za-z ]+" title="Hanya huruf diperbolehkan" required>
                <div class="error-message" id="fullname-error">Nama lengkap harus diisi dan hanya boleh mengandung huruf</div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Status</label>
                <div class="radio-group">
                    <input type="radio" id="status-student" name="status" value="pelajar" class="radio-option" checked>
                    <label for="status-student" class="radio-label">Pelajar</label>
                </div>
            </div>
            
            <!-- Student Fields -->
            <div id="student-fields">
                <div class="form-group">
                    <label for="school-name" class="form-label">Nama Sekolah</label>
                    <input type="text" id="school-name" class="form-control" placeholder="Masukkan nama sekolah" required>
                    <div class="error-message" id="school-error">Nama sekolah harus diisi</div>
                </div>
                
                <div class="form-group">
                    <label for="student-id" class="form-label">NIS (Nomor Induk Siswa)</label>
                    <input type="text" id="student-id" class="form-control" placeholder="Masukkan NIS" pattern="[0-9]+" title="Hanya angka diperbolehkan" required>
                    <div class="error-message" id="nis-error">NIS harus diisi dan hanya boleh mengandung angka</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tujuan Ikut Ujian</label>
                    <div class="radio-group" id="purpose-radio-group">
                        <input type="radio" id="purpose-task" name="purpose" value="Tugas Sekolah" class="radio-option">
                        <label for="purpose-task" class="radio-label">Tugas Sekolah</label>
                        
                        <input type="radio" id="purpose-exam" name="purpose" value="Tugas Ulangan" class="radio-option">
                        <label for="purpose-exam" class="radio-label">Tugas Ulangan</label>
                        
                        <input type="radio" id="purpose-test" name="purpose" value="Tes dan Belajar" class="radio-option">
                        <label for="purpose-test" class="radio-label">Tes dan Belajar</label>
                    </div>
                    <div class="error-message" id="purpose-error">Silakan pilih tujuan ikut ujian</div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tingkat Sekolah</label>
                    <div class="radio-group" id="level-radio-group">
                        <input type="radio" id="level-elementary" name="level" value="SD" class="radio-option">
                        <label for="level-elementary" class="radio-label">SD</label>
                        
                        <input type="radio" id="level-junior" name="level" value="SMP" class="radio-option">
                        <label for="level-junior" class="radio-label">SMP</label>
                        
                        <input type="radio" id="level-senior" name="level" value="SMA/SMK" class="radio-option">
                        <label for="level-senior" class="radio-label">SMA/SMK</label>
                    </div>
                    <div class="error-message" id="level-error">Silakan pilih tingkat sekolah</div>
                </div>
            </div>
            
            <!-- Grade Selection (Will be shown based on school level) -->
            <div id="grade-selection" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Kelas</label>
                    <div class="radio-group" id="grade-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                    <div class="error-message" id="grade-error">Silakan pilih kelas</div>
                </div>
            </div>
            
            <!-- Subject Selection -->
            <div id="subject-selection" style="display: none;">
                <div class="form-group">
                    <label class="form-label">Pilih Jenis Ujian</label>
                    <div class="radio-group" id="subject-radio-group">
                        <input type="radio" id="subject-english" name="subject" value="Bahasa Inggris" class="radio-option" checked>
                        <label for="subject-english" class="radio-label">Bahasa Inggris</label>
                    </div>
                    <div class="error-message" id="subject-error">Silakan pilih jenis ujian</div>
                </div>
            </div>
            
            <!-- Admin Information -->
            <div class="form-group" id="admin-info" style="margin-top: 30px;">
                <p>Informasi berkala dari admin:</p>
                <div style="padding: 15px; background: rgba(0, 0, 0, 0.1); border-radius: 8px;">
                    <p id="admin-message">Tidak ada informasi terbaru saat ini.</p>
                </div>
            </div>
            
            <button id="save-participant-btn" class="btn" disabled>Simpan & Ikut Ujian</button>
        </div>
        
        <!-- Exam Screen (Hidden Initially) -->
        <div id="exam-screen" class="card" style="display: none;">
            <div class="timer" id="exam-timer">02:00:00</div>
            
            <div class="question-container">
                <div class="question" id="question-text">Memuat soal...</div>
                <div id="question-image-container" style="margin-bottom: 15px;"></div>
                
                <div class="options" id="options-container">
                    <!-- Options will be populated by JavaScript -->
                </div>
                
                <div class="explanation" id="explanation-text">
                    <!-- Explanation will be populated by JavaScript -->
                </div>
            </div>
            
            <div class="exam-controls">
                <button id="finish-exam-btn" class="btn btn-danger">Selesaikan Ujian Sekarang</button>
                <button id="skip-question-btn" class="btn btn-warning">Lewati Soal</button>
                <button id="unanswered-btn" class="btn btn-info">Soal Belum Dijawab</button>
            </div>
        </div>
        
        <!-- Results Screen (Hidden Initially) -->
        <div id="results-screen" class="card" style="display: none;">
            <h2>Hasil Ujian</h2>
            
            <div class="results-summary">
                <p>Nama: <span id="result-name"></span></p>
                <p>Status: <span id="result-status"></span></p>
                <p>Tingkat: <span id="result-level"></span></p>
                <p>Kelas: <span id="result-grade"></span></p>
                <p>Mata Ujian: <span id="result-subject"></span></p>
                <p>Jumlah Soal: <span id="total-questions"></span></p>
                <p>Jawaban Benar: <span id="correct-answers"></span></p>
                <p>Jawaban Salah: <span id="wrong-answers"></span></p>
                <p>Tidak Dijawab: <span id="unanswered-questions"></span></p>
                <p>Nilai: <span id="exam-score"></span></p>
            </div>
            
            <div class="certificate-container" id="certificate-container" style="display: none;">
                <!-- Certificate will be generated here -->
            </div>
            
            <div class="result-actions">
                <button id="print-certificate-btn" class="btn btn-success">Cetak Sertifikat</button>
                <button id="retake-exam-btn" class="btn btn-info">Ulangi Ujian</button>
            </div>
        </div>
    </div>
    
    <!-- Floating Buttons -->
    <div class="floating-buttons">
        <button class="floating-btn" id="whatsapp-btn">
            <i class="fab fa-whatsapp"></i>
            <span class="tooltip">Chat Admin</span>
        </button>
        
        <button class="floating-btn" id="admin-panel-btn">
            <i class="fas fa-cog"></i>
            <span class="tooltip">Admin Panel</span>
        </button>
    </div>
    
    <!-- Admin Panel Modal -->
    <div class="modal" id="admin-panel-modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">Kontrol Panel Admin</h3>
                <button class="modal-close" id="close-admin-panel-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="admin-panel-code" class="form-label">Kode Admin</label>
                    <input type="password" id="admin-panel-code" class="form-control" placeholder="Masukkan kode admin" style="color: #333;">
                    <button id="submit-admin-panel-code" class="btn">Masuk</button>
                </div>
                
                <div id="admin-panel-content" style="display: none;">
                    <div class="admin-section">
                        <h5>Pengaturan Kode</h5>
                        <div class="form-group">
                            <label class="form-label">Kode Login Baru</label>
                            <input type="password" id="new-login-code" class="form-control" placeholder="Masukkan kode login baru" style="color: #333;">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Kode Admin Baru</label>
                            <input type="password" id="new-admin-code" class="form-control" placeholder="Masukkan kode admin baru" style="color: #333;">
                        </div>
                        
                        <button id="save-codes-btn" class="btn btn-success">Simpan Kode</button>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Pengaturan Ujian</h5>
                        <div class="admin-controls">
                            <div class="admin-control-group">
                                <label class="admin-control-label">Durasi Ujian (menit)</label>
                                <input type="number" id="exam-duration" class="admin-control-input" value="120" min="5" max="300">
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Pengaturan Konten</h5>
                        <div class="form-group">
                            <label class="form-label">Pesan Pembuka</label>
                            <textarea id="greeting-message-input" class="form-control" rows="3" style="color: #333;">Selamat datang di sistem ujian online Bahasa Inggris PERGUNU Situbondo. Silakan masukkan kode login untuk melanjutkan.</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Pesan Informasi Berkala</label>
                            <textarea id="admin-message-input" class="form-control" rows="3" style="color: #333;">Tidak ada informasi terbaru saat ini.</textarea>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Nama Ketua PERGUNU</label>
                            <input type="text" id="chairman-name" class="form-control" value="Moh. Nuril Hudha, S.Pd., M.Si." style="color: #333;">
                        </div>
                        <button id="save-content-btn" class="btn btn-success">Simpan Perubahan</button>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Manajemen Peserta</h5>
                        <div class="search-box">
                            <input type="text" id="participant-search" class="search-input" placeholder="Cari peserta berdasarkan nama, NIS, atau kode sertifikat...">
                        </div>
                        <div class="participant-actions">
                            <button id="select-all-participants" class="btn btn-info">
                                <input type="checkbox" id="select-all-checkbox" class="select-all-checkbox">
                                Pilih Semua
                            </button>
                            <button id="edit-selected-participants" class="btn btn-warning" disabled>
                                <i class="fas fa-edit"></i> Edit Terpilih
                            </button>
                            <button id="delete-selected-participants" class="btn btn-danger" disabled>
                                <i class="fas fa-trash"></i> Hapus Terpilih
                            </button>
                        </div>
                        <div class="participant-list">
                            <table class="data-table">
                                <thead>
                                    <tr>
                                        <th width="30px">
                                            <!-- Select all checkbox -->
                                        </th>
                                        <th>Tanggal</th>
                                        <th>Nama</th>
                                        <th>NIS</th>
                                        <th>Status</th>
                                        <th>Tingkat</th>
                                        <th>Kelas</th>
                                        <th>Mata Ujian</th>
                                        <th>Nilai</th>
                                        <th>Kode Sertifikat</th>
                                    </tr>
                                </thead>
                                <tbody id="participants-table-body">
                                    <!-- Participant data will be loaded here -->
                                </tbody>
                            </table>
                        </div>
                        <div class="export-buttons">
                            <button id="export-csv-btn" class="btn btn-info">
                                <i class="fas fa-file-csv"></i> Export to CSV
                            </button>
                            <button id="export-json-btn" class="btn btn-info">
                                <i class="fas fa-file-code"></i> Export to JSON
                            </button>
                            <button id="export-excel-btn" class="btn btn-success">
                                <i class="fas fa-file-excel"></i> Export to Excel
                            </button>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Validasi Sertifikat</h5>
                        <div class="certificate-validation">
                            <div class="form-group">
                                <label class="form-label">Masukkan Kode Sertifikat</label>
                                <input type="text" id="certificate-code-input" class="form-control" placeholder="Masukkan kode sertifikat" style="color: #333;">
                                <button id="validate-certificate-btn" class="btn btn-info">Validasi</button>
                            </div>
                            <div id="validation-result" class="validation-result" style="display: none;">
                                <!-- Validation result will be shown here -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="admin-section">
                        <h5>Aktifkan/Nonaktifkan Ujian</h5>
                        <div class="admin-control-group">
                            <label class="admin-control-label">Bahasa Inggris</label>
                            <div class="admin-toggle">
                                <label class="toggle-switch">
                                    <input type="checkbox" id="toggle-english" checked>
                                    <span class="toggle-slider"></span>
                                </label>
                                <span id="english-status">Aktif</span>
                            </div>
                        </div>
                        <button id="save-settings-btn" class="btn btn-success">Simpan Pengaturan</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Edit Participant Modal -->
    <div class="edit-participant-modal" id="edit-participant-modal">
        <div class="edit-participant-content">
            <span class="edit-participant-close" id="close-edit-participant-modal">&times;</span>
            <h3>Edit Data Peserta</h3>
            
            <div class="form-group">
                <label for="edit-fullname" class="form-label">Nama Lengkap</label>
                <input type="text" id="edit-fullname" class="form-control" style="color: #333;" pattern="[A-Za-z ]+" title="Hanya huruf diperbolehkan" required>
            </div>
            
            <div class="form-group">
                <label class="form-label">Status</label>
                <div class="radio-group">
                    <input type="radio" id="edit-status-student" name="edit-status" value="pelajar" class="radio-option" checked>
                    <label for="edit-status-student" class="radio-label">Pelajar</label>
                </div>
            </div>
            
            <div id="edit-student-fields">
                <div class="form-group">
                    <label for="edit-school-name" class="form-label">Nama Sekolah</label>
                    <input type="text" id="edit-school-name" class="form-control" style="color: #333;">
                </div>
                
                <div class="form-group">
                    <label for="edit-student-id" class="form-label">NIS (Nomor Induk Siswa)</label>
                    <input type="text" id="edit-student-id" class="form-control" style="color: #333;" pattern="[0-9]+" title="Hanya angka diperbolehkan" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tujuan Ikut Ujian</label>
                    <div class="radio-group">
                        <input type="radio" id="edit-purpose-task" name="edit-purpose" value="Tugas Sekolah" class="radio-option">
                        <label for="edit-purpose-task" class="radio-label">Tugas Sekolah</label>
                        
                        <input type="radio" id="edit-purpose-exam" name="edit-purpose" value="Tugas Ulangan" class="radio-option">
                        <label for="edit-purpose-exam" class="radio-label">Tugas Ulangan</label>
                        
                        <input type="radio" id="edit-purpose-test" name="edit-purpose" value="Tes dan Belajar" class="radio-option">
                        <label for="edit-purpose-test" class="radio-label">Tes dan Belajar</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Tingkat Sekolah</label>
                    <div class="radio-group">
                        <input type="radio" id="edit-level-elementary" name="edit-level" value="SD" class="radio-option">
                        <label for="edit-level-elementary" class="radio-label">SD</label>
                        
                        <input type="radio" id="edit-level-junior" name="edit-level" value="SMP" class="radio-option">
                        <label for="edit-level-junior" class="radio-label">SMP</label>
                        
                        <input type="radio" id="edit-level-senior" name="edit-level" value="SMA/SMK" class="radio-option">
                        <label for="edit-level-senior" class="radio-label">SMA/SMK</label>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Kelas</label>
                    <div class="radio-group" id="edit-grade-options">
                        <!-- Options will be populated by JavaScript -->
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label class="form-label">Mata Ujian</label>
                <select id="edit-subject" class="form-control" style="color: #333;">
                    <option value="Bahasa Inggris">Bahasa Inggris</option>
                </select>
            </div>
            
            <div class="form-group">
                <label for="edit-score" class="form-label">Nilai</label>
                <input type="number" id="edit-score" class="form-control" min="0" max="100" style="color: #333;">
            </div>
            
            <div class="form-group">
                <label for="edit-certificate-code" class="form-label">Kode Sertifikat</label>
                <input type="text" id="edit-certificate-code" class="form-control" style="color: #333;" readonly>
            </div>
            
            <button id="save-edit-participant-btn" class="btn btn-success">Simpan Perubahan</button>
            
            <input type="hidden" id="edit-participant-index">
        </div>
    </div>
    
    <!-- Notification -->
    <div class="notification" id="time-warning" style="display: none;">
        Perhatian! Ujian akan berakhir dalam waktu 10 menit. Mohon pastikan semua jawaban telah diselesaikan dan diperiksa sebelum waktu habis. Terima kasih atas partisipasi Anda.
    </div>

    <!-- Audio Elements -->
    <audio id="button-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/audiotombol.mp3" preload="auto"></audio>
    <audio id="correct-answer-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/jawabanbenar.mp3" preload="auto"></audio>
    <audio id="wrong-answer-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/jawabansalah.mp3" preload="auto"></audio>
    <audio id="certificate-sound" src="https://github.com/pergunu/pergunusmart/raw/main/assets/audio/applause.mp3" preload="auto"></audio>
    <audio id="opening-sound" src="https://github.com/pergunu/ujian-online/raw/main/assets/audio/opening.mp3" preload="auto"></audio>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script>
        // Global variables
        let currentScreen = 'welcome';
        let participantData = {};
        let examData = {};
        let questions = [];
        let currentQuestionIndex = 0;
        let answeredQuestions = {};
        let examTimer;
        let examTimeLeft = 120 * 60; // 120 minutes in seconds
        let selectedParticipants = [];
        let questionOrder = []; // Untuk menyimpan urutan soal yang diacak

        // URL Google Apps Script untuk penyimpanan data
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbzuh1M0pS64v5e_HYGafcG7CD8RwCEf4FVroKnOT1DujxTdCnn6zTBeQvSwgmenspgN/exec';

        // Audio elements
        const buttonSound = document.getElementById('button-sound');
        const correctAnswerSound = document.getElementById('correct-answer-sound');
        const wrongAnswerSound = document.getElementById('wrong-answer-sound');
        const certificateSound = document.getElementById('certificate-sound');
        const openingSound = document.getElementById('opening-sound');
        
        // Default codes (should be changed in production)
        const DEFAULT_LOGIN_CODE = '12345';
        const DEFAULT_ADMIN_PANEL_CODE = '65614222';
        
        // Store participants data in localStorage
        let participantsData = JSON.parse(localStorage.getItem('pergunuParticipantsData')) || [];
        
        // Store admin settings in localStorage
        let adminSettings = JSON.parse(localStorage.getItem('pergunuAdminSettings')) || {
            loginCode: DEFAULT_LOGIN_CODE,
            adminCode: DEFAULT_ADMIN_PANEL_CODE,
            examDuration: 120,
            greetingMessage: "Selamat datang di sistem ujian online Bahasa Inggris PERGUNU Situbondo. Silakan masukkan kode login untuk melanjutkan.",
            adminMessage: "Tidak ada informasi terbaru saat ini.",
            chairmanName: "Moh. Nuril Hudha, S.Pd., M.Si.",
            enabledSubjects: {
                "Bahasa Inggris": true
            }
        };

        // Expanded Question bank with more questions (Bahasa Inggris only)
        let QUESTION_BANK = {
            'SD': {
                'Bahasa Inggris': [
                    {
                        question: "What is the English translation of 'buku'?",
                        options: [
                            "A. Book",
                            "B. Pen",
                            "C. Table",
                            "D. Chair",
                            "E. Bag"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'Book'. In English, 'buku' is translated as 'book'."
                    },
                    {
                        question: "Which of these is a correct greeting in the morning?",
                        options: [
                            "A. Good afternoon",
                            "B. Good night",
                            "C. Good evening",
                            "D. Good morning",
                            "E. Good bye"
                        ],
                        correctAnswer: 3,
                        explanation: "The correct answer is 'Good morning'. This is the appropriate greeting to use in the morning."
                    },
                    {
                        question: "What is the color of the sky on a clear day?",
                        options: [
                            "A. Red",
                            "B. Green",
                            "C. Blue",
                            "D. Yellow",
                            "E. Black"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Blue'. On a clear day, the sky appears blue."
                    },
                    {
                        question: "How do you say 'terima kasih' in English?",
                        options: [
                            "A. Please",
                            "B. Sorry",
                            "C. Thank you",
                            "D. Excuse me",
                            "E. You're welcome"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Thank you'. 'Terima kasih' is translated as 'Thank you' in English."
                    },
                    {
                        question: "Which of these is a fruit?",
                        options: [
                            "A. Carrot",
                            "B. Potato",
                            "C. Apple",
                            "D. Onion",
                            "E. Cabbage"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Apple'. Apple is a fruit, while the other options are vegetables."
                    },
                    {
                        question: "What is the opposite of 'big'?",
                        options: [
                            "A. Large",
                            "B. Huge",
                            "C. Small",
                            "D. Tall",
                            "E. Wide"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Small'. The opposite of 'big' is 'small'."
                    },
                    {
                        question: "Which animal says 'meow'?",
                        options: [
                            "A. Dog",
                            "B. Cat",
                            "C. Cow",
                            "D. Duck",
                            "E. Bird"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'Cat'. Cats make the sound 'meow'."
                    },
                    {
                        question: "What do you call your father's brother?",
                        options: [
                            "A. Uncle",
                            "B. Aunt",
                            "C. Cousin",
                            "D. Nephew",
                            "E. Grandfather"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'Uncle'. Your father's brother is your uncle."
                    },
                    {
                        question: "Which of these is a number?",
                        options: [
                            "A. Apple",
                            "B. Seven",
                            "C. Happy",
                            "D. Run",
                            "E. Blue"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'Seven'. 'Seven' is a number, while the other options are not."
                    },
                    {
                        question: "What is the English word for 'sekolah'?",
                        options: [
                            "A. Hospital",
                            "B. School",
                            "C. Office",
                            "D. Market",
                            "E. Park"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'School'. 'Sekolah' is translated as 'school' in English."
                    },
                   {
                question: "Read the following text carefully and answer the question:\n\n'The Arctic fox is a small fox native to the Arctic regions of the Northern Hemisphere. It has thick, warm fur that changes color with the seasons: white in winter and brown in summer. This adaptation helps it camouflage in different environments. Arctic foxes primarily feed on lemmings, voles, and other small animals, but they will also eat fish, birds, and berries when available.'\n\nWhat is the main purpose of the Arctic fox's color-changing fur?",
                options: [
                    "A. To attract mates during mating season",
                    "B. To camouflage in different environments",
                    "C. To scare away predators",
                    "D. To absorb more sunlight in winter",
                    "E. To signal danger to other foxes"
                ],
                correctAnswer: 1,
                explanation: "The text explicitly states that the color-changing fur helps the Arctic fox 'camouflage in different environments' (white in snow during winter and brown in summer landscapes)."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Penguins are flightless birds that live primarily in the Southern Hemisphere. Unlike most birds, penguins have flippers instead of wings, which make them excellent swimmers. They spend about half of their lives in water and half on land. Emperor penguins can dive deeper than any other bird, reaching depths of over 500 meters.'\n\nWhich of these statements is NOT true according to the passage?",
                options: [
                    "A. Penguins cannot fly",
                    "B. Penguins live mostly in the Northern Hemisphere",
                    "C. Penguins are excellent swimmers",
                    "D. Emperor penguins can dive very deep",
                    "E. Penguins spend time both in water and on land"
                ],
                correctAnswer: 1,
                explanation: "The passage states penguins live 'primarily in the Southern Hemisphere', making option B the false statement. All other options are directly supported by the text."
            },
            {
                question: "Read the following text and answer the question:\n\n'The Great Pyramid of Giza is the oldest of the Seven Wonders of the Ancient World and the only one still largely intact. Built as a tomb for the Pharaoh Khufu around 2560 BCE, it was the tallest man-made structure in the world for over 3,800 years. The pyramid consists of approximately 2.3 million stone blocks, each weighing an average of 2.5 tons.'\n\nHow long did the Great Pyramid remain the tallest man-made structure in the world?",
                options: [
                    "A. About 1,000 years",
                    "B. About 2,500 years",
                    "C. More than 3,800 years",
                    "D. Exactly 2,560 years",
                    "E. Less than 800 years"
                ],
                correctAnswer: 2,
                explanation: "The text clearly states that the Great Pyramid 'was the tallest man-made structure in the world for over 3,800 years'."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Photosynthesis is the process by which green plants use sunlight to synthesize foods from carbon dioxide and water. This process generally releases oxygen as a byproduct. Photosynthesis is crucial for life on Earth as it provides most of the oxygen necessary for respiration and is the primary source of food for nearly all organisms.'\n\nWhat are the two main products of photosynthesis?",
                options: [
                    "A. Oxygen and carbon dioxide",
                    "B. Water and glucose",
                    "C. Sunlight and chlorophyll",
                    "D. Glucose and oxygen",
                    "E. Carbon dioxide and water"
                ],
                correctAnswer: 3,
                explanation: "The passage indicates that photosynthesis produces food (glucose) and releases oxygen as a byproduct. The other options either include reactants (water, carbon dioxide) or factors (sunlight, chlorophyll) rather than products."
            },
            {
                question: "Read the following text and answer the question:\n\n'Mars, often called the Red Planet, is the fourth planet from the Sun. It has a thin atmosphere composed mostly of carbon dioxide. Mars is home to the largest volcano in the solar system, Olympus Mons, and a vast canyon system called Valles Marineris. Scientists believe Mars may have once had liquid water on its surface.'\n\nWhich of these features is NOT mentioned in the text about Mars?",
                options: [
                    "A. It has a thin atmosphere",
                    "B. It's called the Red Planet",
                    "C. It has rings like Saturn",
                    "D. It has the largest volcano in the solar system",
                    "E. It may have once had liquid water"
                ],
                correctAnswer: 2,
                explanation: "The text mentions all options except for Mars having rings like Saturn. In fact, Mars has no planetary rings."
            },
            {
                question: "Read the following passage and answer the question:\n\n'The human skeleton is made up of 206 bones in adults. Bones serve several important functions: they provide structure to the body, protect internal organs, allow movement when connected to muscles, store minerals like calcium, and produce blood cells in the bone marrow. The smallest bone in the human body is the stapes in the ear, while the largest is the femur in the thigh.'\n\nWhich of these is NOT a function of human bones mentioned in the text?",
                options: [
                    "A. Producing blood cells",
                    "B. Storing minerals",
                    "C. Generating electrical impulses",
                    "D. Protecting internal organs",
                    "E. Allowing movement"
                ],
                correctAnswer: 2,
                explanation: "The text lists all the functions except 'generating electrical impulses', which is a function of the nervous system, not the skeletal system."
            },
            {
                question: "Read the following text and answer the question:\n\n'The water cycle describes how water evaporates from the Earth's surface, rises into the atmosphere, cools and condenses into clouds, and falls back to the surface as precipitation. This continuous movement of water is crucial for distributing fresh water around the planet and maintaining various ecosystems.'\n\nWhat is the correct order of the water cycle processes mentioned?",
                options: [
                    "A. Condensation → Evaporation → Precipitation",
                    "B. Evaporation → Condensation → Precipitation",
                    "C. Precipitation → Evaporation → Condensation",
                    "D. Evaporation → Precipitation → Condensation",
                    "E. Condensation → Precipitation → Evaporation"
                ],
                correctAnswer: 1,
                explanation: "The text clearly describes the sequence as: 1) Evaporation, 2) Condensation (into clouds), and 3) Precipitation."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Pluto, once considered the ninth planet, was reclassified as a dwarf planet in 2006. This decision was made because Pluto shares its orbital neighborhood with other objects in the Kuiper belt and hasn't cleared its orbit of other debris. Pluto has five known moons, the largest being Charon, which is about half Pluto's size.'\n\nWhy was Pluto reclassified as a dwarf planet?",
                options: [
                    "A. Because it's too small to be a planet",
                    "B. Because it hasn't cleared its orbit of other debris",
                    "C. Because it's too far from the Sun",
                    "D. Because it has too many moons",
                    "E. Because its surface is too icy"
                ],
                correctAnswer: 1,
                explanation: "The text states Pluto was reclassified because it 'hasn't cleared its orbit of other debris', which is one of the criteria for being a full planet according to the International Astronomical Union's definition."
            },
            {
                question: "Read the following text and answer the question:\n\n'The Industrial Revolution began in Britain in the late 18th century and transformed society from agrarian to industrial. Key inventions like the steam engine, spinning jenny, and power loom mechanized production. This led to urbanization as people moved from rural areas to work in factories, dramatically changing living conditions and social structures.'\n\nWhat was one major social effect of the Industrial Revolution mentioned in the text?",
                options: [
                    "A. Decrease in population",
                    "B. Increase in farm production",
                    "C. Urbanization as people moved to cities",
                    "D. Return to simpler living conditions",
                    "E. Decrease in technological development"
                ],
                correctAnswer: 2,
                explanation: "The text specifically mentions 'urbanization as people moved from rural areas to work in factories' as a major social effect of the Industrial Revolution."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Electricity is the flow of electric charge, typically carried by electrons through conductors like copper wires. It can be generated from various sources including fossil fuels, nuclear power, and renewable sources like wind and solar. Electricity is essential for modern life, powering everything from lights and appliances to computers and medical equipment.'\n\nWhich of these is NOT mentioned as a source of electricity in the text?",
                options: [
                    "A. Fossil fuels",
                    "B. Nuclear power",
                    "C. Wind energy",
                    "D. Solar energy",
                    "E. Geothermal energy"
                ],
                correctAnswer: 4,
                explanation: "The text mentions fossil fuels, nuclear power, wind, and solar as electricity sources, but does not mention geothermal energy."
            },
		{
                question: "Choose the correct sentence structure:\n\nA. She go to school every day.\nB. She goes to school every day.\nC. She going to school every day.\nD. She is go to school every day.\nE. She does goes to school every day.",
                options: [
                    "A. She go to school every day.",
                    "B. She goes to school every day.",
                    "C. She going to school every day.",
                    "D. She is go to school every day.",
                    "E. She does goes to school every day."
                ],
                correctAnswer: 1,
                explanation: "The correct answer is B because for third person singular (she/he/it), we add -s/-es to the base verb in simple present tense."
            },
            {
                question: "Which word is the antonym of 'generous'?",
                options: [
                    "A. Kind",
                    "B. Selfish",
                    "C. Friendly",
                    "D. Helpful",
                    "E. Brave"
                ],
                correctAnswer: 1,
                explanation: "The antonym of 'generous' (willing to give) is 'selfish' (caring only about oneself)."
            },
            {
                question: "Read the sentence and choose the correct punctuation:\n\n___ wow ___ that was amazing ___ shouted Tina",
                options: [
                    "A. 'Wow! That was amazing!' shouted Tina.",
                    "B. 'Wow, that was amazing' shouted Tina.",
                    "C. 'Wow that was amazing!' shouted Tina.",
                    "D. 'Wow, that was amazing!' shouted Tina.",
                    "E. 'Wow! that was amazing,' shouted Tina."
                ],
                correctAnswer: 3,
                explanation: "Option D is correct because: 1) 'Wow' needs comma after interjection, 2) The whole quote needs exclamation mark, 3) The sentence ends with a period."
            },
            {
                question: "Complete the analogy:\n\nBook is to reading as fork is to ___.",
                options: [
                    "A. Writing",
                    "B. Eating",
                    "C. Cooking",
                    "D. Cutting",
                    "E. Drinking"
                ],
                correctAnswer: 1,
                explanation: "The relationship is tool to its primary function. We read books just as we eat with forks."
            },
            {
                question: "Identify the adjective in this sentence:\n\nThe playful puppy chased its blue ball in the large garden.",
                options: [
                    "A. Puppy",
                    "B. Chased",
                    "C. Playful",
                    "D. Its",
                    "E. In"
                ],
                correctAnswer: 2,
                explanation: "'Playful' is the adjective describing the noun 'puppy'. 'Blue' and 'large' are also adjectives, but they're not among the options."
            },
            {
                question: "Which sentence is in the future tense?",
                options: [
                    "A. She is singing a song.",
                    "B. They played football yesterday.",
                    "C. We will visit the museum tomorrow.",
                    "D. I eat breakfast every morning.",
                    "E. He has finished his homework."
                ],
                correctAnswer: 2,
                explanation: "Option C uses 'will visit' which indicates future tense. The time word 'tomorrow' also confirms this."
            },
            {
                question: "Read the passage and answer:\n\n'Dolphins are highly intelligent marine mammals. They live in groups called pods and communicate using clicks and whistles. Dolphins can recognize themselves in mirrors, a sign of self-awareness.'\n\nWhat evidence suggests dolphins are intelligent?",
                options: [
                    "A. They live in pods",
                    "B. They communicate with sounds",
                    "C. They can recognize themselves in mirrors",
                    "D. They are marine mammals",
                    "E. They swim fast"
                ],
                correctAnswer: 2,
                explanation: "Self-recognition in mirrors (option C) is specifically mentioned as a sign of intelligence. While options A and B are true, they don't directly indicate intelligence."
            },
            {
                question: "Choose the correctly spelled word:",
                options: [
                    "A. Recieve",
                    "B. Neice",
                    "C. Wierd",
                    "D. Separate",
                    "E. Occured"
                ],
                correctAnswer: 3,
                explanation: "'Separate' is correctly spelled. The others should be: A) Receive, B) Niece, C) Weird, E) Occurred."
            },
            {
                question: "Which prefix can be added to 'happy' to form its opposite?",
                options: [
                    "A. re-",
                    "B. un-",
                    "C. pre-",
                    "D. dis-",
                    "E. mis-"
                ],
                correctAnswer: 1,
                explanation: "The correct prefix is 'un-' to form 'unhappy'. While 'dis-' can form opposites (like 'disagree'), it's not used with 'happy'."
            },
            {
                question: "What is the plural form of 'child'?",
                options: [
                    "A. Childs",
                    "B. Children",
                    "C. Childes",
                    "D. Childen",
                    "E. Childrens"
                ],
                correctAnswer: 1,
                explanation: "'Children' is the irregular plural form of 'child'. Adding -s or -es (options A, C) would be incorrect."
            },
		 {
                question: "Which sentence is correct?",
                options: [
                    "A. There is many books on the table.",
                    "B. There are many book on the table.",
                    "C. There are many books on the table.",
                    "D. There is many book on the table.",
                    "E. There are much books on the table."
                ],
                correctAnswer: 2,
                explanation: "The correct answer is C because 'books' is plural and requires the plural verb 'are'. 'Many' is used with countable plural nouns."
            },
            {
                question: "Choose the correct possessive form:\n\nThis is ___ bicycle.",
                options: [
                    "A. Peters",
                    "B. Peter's",
                    "C. Peters'",
                    "D. Peters's",
                    "E. Peter"
                ],
                correctAnswer: 1,
                explanation: "For singular nouns (Peter), we add 's to show possession. So the correct form is 'Peter's bicycle'."
            },
            {
                question: "What is the opposite of 'ancient'?",
                options: [
                    "A. Old",
                    "B. Modern",
                    "C. Historic",
                    "D. Classic",
                    "E. Aged"
                ],
                correctAnswer: 1,
                explanation: "The opposite of 'ancient' (very old) is 'modern' (relating to the present or recent times)."
            },
            {
                question: "Which word is NOT a preposition?",
                options: [
                    "A. Under",
                    "B. Between",
                    "C. Quickly",
                    "D. Behind",
                    "E. Across"
                ],
                correctAnswer: 2,
                explanation: "'Quickly' is an adverb, not a preposition. All other options show position or location, which are prepositions."
            },
            {
                question: "Complete the sentence:\n\nIf it rains tomorrow, we ___ the picnic.",
                options: [
                    "A. will cancel",
                    "B. cancels",
                    "C. cancel",
                    "D. would cancel",
                    "E. are canceling"
                ],
                correctAnswer: 0,
                explanation: "This is a first conditional sentence. We use 'will + base verb' in the main clause when the condition is possible in the future."
            },
            {
                question: "Read the sentence and choose the correct question tag:\n\nShe can swim very well, ___?",
                options: [
                    "A. can she",
                    "B. can't she",
                    "C. doesn't she",
                    "D. isn't she",
                    "E. couldn't she"
                ],
                correctAnswer: 1,
                explanation: "The question tag for positive statements with 'can' is 'can't + pronoun'. So 'can't she' is correct."
            },
            {
                question: "Which word sounds different? (Pronunciation)",
                options: [
                    "A. Cat",
                    "B. Hat",
                    "C. Bat",
                    "D. Mate",
                    "E. Rat"
                ],
                correctAnswer: 3,
                explanation: "'Mate' has a long 'a' sound (/eɪ/) while the others have short 'a' sound (/æ/). This tests phonics awareness."
            },
            {
                question: "What is the comparative form of 'good'?",
                options: [
                    "A. Gooder",
                    "B. More good",
                    "C. Better",
                    "D. Best",
                    "E. Well"
                ],
                correctAnswer: 2,
                explanation: "'Good' is an irregular adjective. Its comparative form is 'better' and superlative is 'best'."
            },
            {
                question: "Identify the conjunction in this sentence:\n\nI wanted to play outside, but it was raining.",
                options: [
                    "A. I",
                    "B. wanted",
                    "C. outside",
                    "D. but",
                    "E. raining"
                ],
                correctAnswer: 3,
                explanation: "'But' is a coordinating conjunction that connects two independent clauses showing contrast."
            },
            {
                question: "Which sentence is in the present continuous tense?",
                options: [
                    "A. She writes a letter.",
                    "B. She wrote a letter.",
                    "C. She is writing a letter.",
                    "D. She has written a letter.",
                    "E. She will write a letter."
                ],
                correctAnswer: 2,
                explanation: "Present continuous tense is formed with 'is/am/are + verb-ing'. So 'is writing' is correct."
            },
		{
                question: "Which of these is a proper noun?",
                options: [
                    "A. city",
                    "B. country",
                    "C. Jakarta",
                    "D. mountain",
                    "E. ocean"
                ],
                correctAnswer: 2,
                explanation: "Jakarta is a proper noun because it's the specific name of a city. The other options are common nouns."
            },
            {
                question: "Choose the correct word to complete the sentence:\n\nI ___ my teeth three times a day.",
                options: [
                    "A. brushes",
                    "B. brush",
                    "C. brushing",
                    "D. brushed",
                    "E. brushs"
                ],
                correctAnswer: 1,
                explanation: "The subject 'I' requires the base form of the verb 'brush' in simple present tense."
            },
            {
                question: "What is the past tense of 'go'?",
                options: [
                    "A. goed",
                    "B. went",
                    "C. gone",
                    "D. goes",
                    "E. going"
                ],
                correctAnswer: 1,
                explanation: "The irregular past tense of 'go' is 'went'. 'Gone' is the past participle."
            },
            {
                question: "Which sentence is punctuated correctly?",
                options: [
                    "A. My favorite colors are red blue and green.",
                    "B. My favorite colors are red, blue and green.",
                    "C. My favorite colors are red, blue, and green.",
                    "D. My favorite colors are, red blue and green.",
                    "E. My favorite colors are: red blue and green."
                ],
                correctAnswer: 2,
                explanation: "Option C uses the Oxford comma correctly in a list of three or more items."
            },
            {
                question: "Identify the adverb in this sentence:\n\nThe turtle moves very slowly.",
                options: [
                    "A. turtle",
                    "B. moves",
                    "C. very",
                    "D. slowly",
                    "E. the"
                ],
                correctAnswer: 3,
                explanation: "'Slowly' is an adverb modifying the verb 'moves'. 'Very' is also an adverb but it modifies 'slowly'."
            },
            {
                question: "What is the superlative form of 'far'?",
                options: [
                    "A. far",
                    "B. farther",
                    "C. farthest",
                    "D. more far",
                    "E. most far"
                ],
                correctAnswer: 2,
                explanation: "The superlative form of 'far' is 'farthest'. 'Farther' is the comparative form."
            },
            {
                question: "Which word is spelled incorrectly?",
                options: [
                    "A. February",
                    "B. Wensday",
                    "C. November",
                    "D. September",
                    "E. October"
                ],
                correctAnswer: 1,
                explanation: "The correct spelling is 'Wednesday'. All other month names are spelled correctly."
            },
            {
                question: "Choose the correct contraction:\n\n___ going to the park later.",
                options: [
                    "A. Were",
                    "B. We're",
                    "C. We'll",
                    "D. We'd",
                    "E. We've"
                ],
                correctAnswer: 1,
                explanation: "'We're' is the contraction of 'we are', which fits the sentence structure."
            },
            {
                question: "What type of word is 'beautiful' in this sentence?\n\nShe has a beautiful voice.",
                options: [
                    "A. noun",
                    "B. verb",
                    "C. adjective",
                    "D. adverb",
                    "E. pronoun"
                ],
                correctAnswer: 2,
                explanation: "'Beautiful' is an adjective describing the noun 'voice'."
            },
            {
                question: "Which sentence is in the past continuous tense?",
                options: [
                    "A. She reads a book.",
                    "B. She read a book.",
                    "C. She is reading a book.",
                    "D. She was reading a book.",
                    "E. She has read a book."
                ],
                correctAnswer: 3,
                explanation: "Past continuous tense uses 'was/were + verb-ing'. 'Was reading' is the correct form."
            } 
                ]
            },
            'SMP': {
                'Bahasa Inggris': [
                    {
                        question: "Which sentence is in the present continuous tense?",
                        options: [
                            "A. I eat breakfast every morning.",
                            "B. I am eating breakfast now.",
                            "C. I ate breakfast an hour ago.",
                            "D. I will eat breakfast later.",
                            "E. I have eaten breakfast already."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'I am eating breakfast now.' This sentence uses the present continuous tense (am + verb-ing) to describe an action happening now."
                    },
                    {
                        question: "What is the comparative form of 'good'?",
                        options: [
                            "A. Gooder",
                            "B. More good",
                            "C. Better",
                            "D. Best",
                            "E. Well"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Better'. The comparative form of the irregular adjective 'good' is 'better'."
                    },
                    {
                        question: "Which of these is a correct question in simple past tense?",
                        options: [
                            "A. Did you went to school yesterday?",
                            "B. Did you go to school yesterday?",
                            "C. Do you went to school yesterday?",
                            "D. Does you go to school yesterday?",
                            "E. Are you go to school yesterday?"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'Did you go to school yesterday?'. In simple past tense questions, we use 'did' + base form of the verb."
                    },
                    {
                        question: "What is the plural form of 'child'?",
                        options: [
                            "A. Childs",
                            "B. Children",
                            "C. Childes",
                            "D. Childen",
                            "E. Childrens"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'Children'. 'Child' is an irregular noun and its plural form is 'children'."
                    },
                    {
                        question: "Which sentence is correct?",
                        options: [
                            "A. She don't like coffee.",
                            "B. She doesn't likes coffee.",
                            "C. She doesn't like coffee.",
                            "D. She not like coffee.",
                            "E. She no like coffee."
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'She doesn't like coffee.'. With third person singular (she), we use 'doesn't' + base form of the verb."
                    },
                    {
                        question: "What is the past participle of 'write'?",
                        options: [
                            "A. Writed",
                            "B. Wrote",
                            "C. Written",
                            "D. Writing",
                            "E. Writes"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Written'. The past participle of the irregular verb 'write' is 'written'."
                    },
                    {
                        question: "Which word is an adverb?",
                        options: [
                            "A. Happy",
                            "B. Happiness",
                            "C. Happily",
                            "D. Happier",
                            "E. Happiest"
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Happily'. This is an adverb formed by adding '-ly' to the adjective 'happy'."
                    },
                    {
                        question: "What is the correct tag question for: 'You're coming to the party, _____?'",
                        options: [
                            "A. aren't you",
                            "B. are you",
                            "C. isn't you",
                            "D. don't you",
                            "E. won't you"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'aren't you'. The main clause is 'You're coming' (you are coming), so the tag question should be 'aren't you'."
                    },
                    {
                        question: "Which sentence uses 'there is' correctly?",
                        options: [
                            "A. There is many books on the table.",
                            "B. There is a book on the table.",
                            "C. There is some books on the table.",
                            "D. There is few books on the table.",
                            "E. There is several books on the table."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'There is a book on the table.'. 'There is' is used with singular nouns (a book)."
                    },
                    {
                        question: "What is the opposite of 'expensive'?",
                        options: [
                            "A. Cheap",
                            "B. Costly",
                            "C. Valuable",
                            "D. Priceless",
                            "E. Worthy"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'Cheap'. The opposite of 'expensive' is 'cheap'."
                    },
                   {
                question: "Read the following passage carefully and answer the question:\n\n'The rapid advancement of artificial intelligence has sparked debates about its potential impact on employment. While some experts predict massive job displacement, others argue that AI will create new types of jobs that don't exist today. Historical precedents show that technological revolutions typically lead to job transformation rather than pure elimination. However, the scale and speed of AI adoption may present unique challenges that require proactive policy responses and educational reforms.'\n\nWhat is the main idea of this passage?",
                options: [
                    "A. AI will definitely eliminate most jobs in the future",
                    "B. The impact of AI on employment is a subject of debate with various perspectives",
                    "C. Historical technological revolutions had no impact on employment",
                    "D. Educational reforms are unnecessary in the age of AI",
                    "E. All experts agree that AI will create more jobs than it eliminates"
                ],
                correctAnswer: 1,
                explanation: "The passage presents different perspectives on AI's impact on employment without reaching a definitive conclusion, making option B the most accurate summary of the main idea."
            },
            {
                question: "Read the following text and choose the correct answer:\n\n'Climate change mitigation requires concerted global efforts. The Paris Agreement, adopted in 2015, represents a landmark international accord where nations pledged to limit global warming to well below 2°C above pre-industrial levels. However, current national commitments fall short of this target, necessitating more ambitious actions across all sectors of society.'\n\nWhat does the word 'mitigation' most likely mean in this context?",
                options: [
                    "A. The act of making something less severe or serious",
                    "B. The complete elimination of a problem",
                    "C. The scientific study of climate patterns",
                    "D. The adaptation to inevitable changes",
                    "E. The postponement of necessary actions"
                ],
                correctAnswer: 0,
                explanation: "In the context of climate change, 'mitigation' refers to efforts to reduce or prevent the emission of greenhouse gases, making option A the correct choice."
            },
            {
                question: "Identify the sentence that contains a grammatical error:",
                options: [
                    "A. Neither the students nor the teacher was aware of the schedule change.",
                    "B. Each of the participants have received their study materials.",
                    "C. The data collected from the experiment shows significant results.",
                    "D. There are many factors to consider when analyzing economic trends.",
                    "E. She is one of those people who always arrive on time."
                ],
                correctAnswer: 1,
                explanation: "Option B contains an error because 'each' is singular and requires the singular verb 'has' instead of 'have'."
            },
            {
                question: "Read the following passage and answer the question:\n\n'The Renaissance period marked a cultural rebirth in Europe between the 14th and 17th centuries. Characterized by renewed interest in classical learning and values, it saw extraordinary developments in art, literature, and science. Figures like Leonardo da Vinci epitomized the 'Renaissance man' ideal of broad expertise across multiple disciplines.'\n\nWhat does the term 'Renaissance man' imply in this context?",
                options: [
                    "A. Someone who lived during the Renaissance period",
                    "B. A person with exceptional skill in a single area",
                    "C. An individual with knowledge and abilities in many fields",
                    "D. A male artist from Italy",
                    "E. A scholar who studied ancient Greek texts"
                ],
                correctAnswer: 2,
                explanation: "The term 'Renaissance man' refers to someone with expertise in multiple areas, as exemplified by Leonardo da Vinci who was both an artist and a scientist."
            },
            {
                question: "Which of the following sentences uses the subjunctive mood correctly?",
                options: [
                    "A. If I was you, I would reconsider that decision.",
                    "B. I suggest that he goes to the doctor immediately.",
                    "C. It's essential that she be informed about the changes.",
                    "D. They demanded that the manager is present at the meeting.",
                    "E. Suppose we would have left earlier, we might have arrived on time."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses the subjunctive mood with the base form 'be' after the phrase 'it's essential that'."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Postmodern literature often rejects traditional narrative structures and embraces fragmentation, paradox, and unreliable narration. Works in this genre frequently blur the boundaries between fiction and reality, challenging readers' expectations and assumptions about storytelling.'\n\nBased on the passage, which of the following would most likely be a characteristic of postmodern literature?",
                options: [
                    "A. A straightforward, chronological plot",
                    "B. Clear distinctions between what's real and what's fictional",
                    "C. A single, authoritative narrator",
                    "D. Contradictory versions of the same events",
                    "E. Conventional character development"
                ],
                correctAnswer: 3,
                explanation: "The passage mentions that postmodern literature embraces paradox and unreliable narration, making contradictory versions of events (option D) a likely characteristic."
            },
            {
                question: "Choose the sentence that best combines these two sentences while maintaining their original meaning:\n\n'The experiment yielded unexpected results. The scientists decided to repeat it with stricter controls.'",
                options: [
                    "A. The experiment yielded unexpected results, but the scientists decided to repeat it with stricter controls.",
                    "B. Because the experiment yielded unexpected results, the scientists decided to repeat it with stricter controls.",
                    "C. The experiment yielded unexpected results when the scientists decided to repeat it with stricter controls.",
                    "D. The experiment yielded unexpected results, so the scientists decided to repeat it with stricter controls.",
                    "E. Both B and D are correct combinations."
                ],
                correctAnswer: 4,
                explanation: "Both options B and D correctly show the causal relationship between the unexpected results and the decision to repeat the experiment, using appropriate conjunctions ('because' and 'so')."
            },
            {
                question: "Identify the rhetorical device used in the following sentence:\n\n'Ask not what your country can do for you; ask what you can do for your country.'",
                options: [
                    "A. Simile",
                    "B. Metaphor",
                    "C. Chiasmus",
                    "D. Hyperbole",
                    "E. Onomatopoeia"
                ],
                correctAnswer: 2,
                explanation: "This is an example of chiasmus, a rhetorical device where words or concepts are repeated in reverse order to create an inverted parallelism."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Cognitive dissonance theory suggests that individuals experience psychological discomfort when holding conflicting beliefs or when their behavior contradicts their beliefs. To reduce this discomfort, people may change their beliefs, justify their behavior, or seek information that supports their existing views.'\n\nWhich of the following scenarios best illustrates cognitive dissonance?",
                options: [
                    "A. A student who studies regularly and performs well on exams",
                    "B. A smoker who knows smoking causes cancer but continues to smoke",
                    "C. An athlete who trains hard and wins competitions",
                    "D. A vegetarian who refuses to eat meat",
                    "E. A teacher who prepares lessons carefully and receives positive evaluations"
                ],
                correctAnswer: 1,
                explanation: "The smoker scenario (option B) demonstrates cognitive dissonance because it involves a contradiction between knowledge (smoking is harmful) and behavior (continuing to smoke)."
            },
            {
                question: "Which of the following sentences contains a dangling modifier?",
                options: [
                    "A. Running quickly, the boy caught the bus.",
                    "B. After finishing the assignment, the TV was turned on.",
                    "C. She saw the dog that had bitten her neighbor.",
                    "D. The book, which was very expensive, fell on the floor.",
                    "E. Having studied all night, he was prepared for the exam."
                ],
                correctAnswer: 1,
                explanation: "Option B contains a dangling modifier because the phrase 'After finishing the assignment' doesn't logically modify the subject 'the TV' that follows it."
            },
		{
                question: "Read the following passage and answer the question:\n\n'The concept of biodiversity hotspots refers to regions that contain at least 1,500 species of vascular plants as endemics and have lost at least 70% of their primary vegetation. These areas, representing just 2.4% of Earth's land surface, support more than half of the world's plant species and nearly 43% of bird, mammal, reptile, and amphibian species.'\n\nWhat is the primary purpose of this passage?",
                options: [
                    "A. To criticize human impact on the environment",
                    "B. To define and highlight the importance of biodiversity hotspots",
                    "C. To compare different types of ecosystems",
                    "D. To argue for increased urban development",
                    "E. To list all endangered species in the world"
                ],
                correctAnswer: 1,
                explanation: "The passage primarily serves to define what biodiversity hotspots are and emphasize their ecological significance through specific statistics."
            },
            {
                question: "Which of the following sentences uses the passive voice correctly?",
                options: [
                    "A. The committee has been reached a decision yesterday.",
                    "B. A new school record was set by the athlete last week.",
                    "C. The students have wrote their essays before the deadline.",
                    "D. The manager will held a meeting tomorrow.",
                    "E. The project is being complete by the team now."
                ],
                correctAnswer: 1,
                explanation: "Option B is the only sentence with proper passive construction: 'was set' (past simple passive) with the agent 'by the athlete'."
            },
            {
                question: "Identify the sentence with the correct use of articles:",
                options: [
                    "A. She wants to be an architect when she grows up.",
                    "B. I saw the interesting movie last night.",
                    "C. He is a honest man who always tells truth.",
                    "D. They traveled to United States last summer.",
                    "E. Please pass me a salt that is on the table."
                ],
                correctAnswer: 0,
                explanation: "Option A correctly uses 'an' before 'architect' (vowel sound). Other options misuse articles: B needs 'an', C needs 'an honest', D needs 'the', E needs 'the salt'."
            },
            {
                question: "Read the dialogue and choose the most appropriate response:\n\nSpeaker A: 'I'm thinking about adopting a dog, but I'm not sure if I have enough time to care for it properly.'\n\nSpeaker B:",
                options: [
                    "A. 'Dogs are better than cats anyway.'",
                    "B. "'You should consider your daily schedule carefully before making this commitment.'",
                    "C. "'All of my friends have dogs.'",
                    "D. "'Pets are too expensive these days.'",
                    "E. "'I prefer fish as pets.'"
                ],
                correctAnswer: 1,
                explanation: "Option B provides the most relevant and thoughtful response that addresses Speaker A's concern about time commitment."
            },
            {
                question: "Which of these words is an example of a 'false cognate' in English and Indonesian?",
                options: [
                    "A. Television (English) - televisi (Indonesian)",
                    "B. Library (English) - perpustakaan (Indonesian)",
                    "C. Actual (English) - aktual (Indonesian)",
                    "D. Computer (English) - komputer (Indonesian)",
                    "E. Radio (English) - radio (Indonesian)"
                ],
                correctAnswer: 2,
                explanation: "'Actual' in English means 'real', while 'aktual' in Indonesian means 'current' or 'topical', making them false cognates with different meanings."
            },
            {
                question: "Read the passage and identify the tone:\n\n'While technological advancements have undoubtedly improved our quality of life in many ways, one cannot help but wonder whether we have sacrificed too much human connection in the process. The sight of families sitting together, each absorbed in their individual devices, has become all too common.'",
                options: [
                    "A. Enthusiastic",
                    "B. Neutral",
                    "C. Nostalgic",
                    "D. Critical",
                    "E. Humorous"
                ],
                correctAnswer: 3,
                explanation: "The tone is critical as it questions the negative social impact of technology despite acknowledging its benefits."
            },
            {
                question: "Choose the correct sequence to form a coherent paragraph:\n\n1. However, excessive screen time has been linked to various health issues.\n2. Digital devices have become indispensable in modern education.\n3. Therefore, finding the right balance is crucial for students.\n4. They provide access to vast information and interactive learning tools.",
                options: [
                    "A. 2-4-1-3",
                    "B. 1-3-2-4",
                    "C. 4-2-3-1",
                    "D. 3-1-4-2",
                    "E. 2-1-4-3"
                ],
                correctAnswer: 0,
                explanation: "The correct sequence is 2-4-1-3: Starts with importance of devices (2), explains benefits (4), contrasts with problems (1), concludes with need for balance (3)."
            },
            {
                question: "Identify the literary device in this sentence:\n\n'The wind whispered through the trees, sharing secrets with the leaves.'",
                options: [
                    "A. Simile",
                    "B. Metaphor",
                    "C. Personification",
                    "D. Alliteration",
                    "E. Onomatopoeia"
                ],
                correctAnswer: 2,
                explanation: "This is personification because human qualities (whispering, sharing secrets) are attributed to the non-human wind."
            },
            {
                question: "Which sentence contains a subordinate clause?",
                options: [
                    "A. The sun rose and the birds began to sing.",
                    "B. After the rain stopped, we went outside to play.",
                    "C. She studied hard and passed the exam.",
                    "D. They wanted to travel but couldn't afford it.",
                    "E. The movie was long yet interesting."
                ],
                correctAnswer: 1,
                explanation: "Option B contains the subordinate clause 'After the rain stopped' which cannot stand alone as a complete sentence."
            },
            {
                question: "Read the passage and answer:\n\n'Cultural appropriation refers to the adoption of elements of one culture by members of another culture. When done respectfully and with understanding, it can promote cross-cultural exchange. However, problems arise when these elements are taken out of context, stripped of their original meaning, or used in ways that mock or stereotype the source culture.'\n\nWhat is the key factor that distinguishes problematic cultural appropriation?",
                options: [
                    "A. The popularity of the cultural elements",
                    "B. The lack of respect and understanding",
                    "C. The age of the cultural tradition",
                    "D. The number of people involved",
                    "E. The country of origin"
                ],
                correctAnswer: 1,
                explanation: "The passage clearly indicates that lack of respect and understanding leads to problematic appropriation, while respectful adoption can be positive."
            },
		{
                question: "Read this sentence and choose the correct interpretation:\n\n'Had the weather been better, we would have visited the national park.'",
                options: [
                    "A. We visited the park despite bad weather",
                    "B. We didn't visit the park because of the weather",
                    "C. We might visit the park if weather improves",
                    "D. The weather was perfect for park visitation",
                    "E. We always visit parks in good weather"
                ],
                correctAnswer: 1,
                explanation: "This third conditional structure indicates the park visit didn't happen due to poor weather conditions."
            },
            {
                question: "Which sentence correctly uses parallel structure?",
                options: [
                    "A. She likes hiking, swimming, and to ride bicycles",
                    "B. The teacher asked us to read quietly, to take notes, and writing summaries",
                    "C. My goals are finishing school, getting a job, and to buy a house",
                    "D. We need to buy groceries, do laundry, and clean the house",
                    "E. He excels at math, science, and in history class"
                ],
                correctAnswer: 3,
                explanation: "Option D maintains parallel structure with all verbs in base form (buy, do, clean)."
            },
            {
                question: "Read the passage and identify the main organizational pattern:\n\n'Global warming affects ecosystems in multiple ways. First, rising temperatures cause habitat loss. Second, climate change alters migration patterns. Finally, ocean acidification harms marine life.'",
                options: [
                    "A. Cause and effect",
                    "B. Chronological order",
                    "C. Problem-solution",
                    "D. Listing/Enumeration",
                    "E. Comparison-contrast"
                ],
                correctAnswer: 3,
                explanation: "The passage uses enumeration (First, Second, Finally) to list effects of global warming."
            },
            {
                question: "Choose the correct phrasal verb to complete the sentence:\n\n'After much deliberation, the committee _____ a new policy last week.'",
                options: [
                    "A. came up with",
                    "B. ran out of",
                    "C. got away with",
                    "D. looked forward to",
                    "E. put up with"
                ],
                correctAnswer: 0,
                explanation: "'Came up with' means 'created' or 'developed', fitting the context of policy creation."
            },
            {
                question: "Identify the sentence with correct punctuation:",
                options: [
                    "A. The students' books were left in the library, however they were returned the next day.",
                    "B. The students books' were left in the library; however, they were returned the next day.",
                    "C. The students' books were left in the library; however, they were returned the next day.",
                    "D. The students books were left in the library, however; they were returned the next day.",
                    "E. The student's books were left in the library however they were returned the next day."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses: 1) apostrophe for plural possessive, 2) semicolon before conjunctive adverb, 3) comma after 'however'."
            },
            {
                question: "Which option best restates this sentence?\n\n'Contrary to popular belief, bats are not blind.'",
                options: [
                    "A. Most people think bats can't see, but this is incorrect",
                    "B. Bats have better vision than most animals",
                    "C. People believe bats have special vision abilities",
                    "D. Blindness in bats is more common than people think",
                    "E. Scientific studies prove bats are becoming blind"
                ],
                correctAnswer: 0,
                explanation: "Option A accurately preserves the original meaning about correcting a common misconception."
            },
            {
                question: "Read the dialogue and choose the most logical response:\n\nSpeaker A: 'The new environmental regulations might affect our production costs.'\n\nSpeaker B:",
                options: [
                    "A. 'I love environmental documentaries.'",
                    "B. "'We should analyze how much compliance will cost versus potential fines.'",
                    "C. "'Production always increases in summer.'",
                    "D. "'Our competitors have nice uniforms.'",
                    "E. "'The weather has been unusual this year.'"
                ],
                correctAnswer: 1,
                explanation: "Option B directly addresses the concern about regulations with a practical business response."
            },
            {
                question: "Which sentence contains a restrictive clause?",
                options: [
                    "A. My brother, who lives in Jakarta, is visiting us.",
                    "B. The textbook that I borrowed from you is very helpful.",
                    "C. Mrs. Smith, our English teacher, gives interesting assignments.",
                    "D. Bali, which is a popular tourist destination, has beautiful beaches.",
                    "E. The concert, which lasted three hours, was amazing."
                ],
                correctAnswer: 1,
                explanation: "Option B's clause 'that I borrowed from you' is restrictive (essential to identify which textbook)."
            },
            {
                question: "Read the passage and identify the author's purpose:\n\n'Many schools have eliminated art programs due to budget cuts. This is shortsighted because arts education develops creativity, improves academic performance, and fosters cultural appreciation. Communities should prioritize funding for these vital programs.'",
                options: [
                    "A. To narrate a personal experience",
                    "B. To persuade readers about art education's value",
                    "C. To explain how budget cuts happen",
                    "D. To describe different art forms",
                    "E. To compare school programs"
                ],
                correctAnswer: 1,
                explanation: "The author presents arguments to convince readers about preserving art programs."
            },
            {
                question: "Choose the correct word to complete the analogy:\n\nEPHEMERAL : PERMANENT :: _____ : COMPLEX",
                options: [
                    "A. Simple",
                    "B. Difficult",
                    "C. Beautiful",
                    "D. Ancient",
                    "E. Modern"
                ],
                correctAnswer: 0,
                explanation: "The analogy shows antonyms - ephemeral is the opposite of permanent, just as simple is the opposite of complex."
            } 
                ]
            },
            'SMA/SMK': {
                'Bahasa Inggris': [
                    {
                        question: "Which sentence is in the present perfect continuous tense?",
                        options: [
                            "A. I have finished my homework.",
                            "B. I have been finishing my homework.",
                            "C. I had finished my homework.",
                            "D. I will have finished my homework.",
                            "E. I am finishing my homework."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'I have been finishing my homework.'. This sentence uses the present perfect continuous tense (have been + verb-ing)."
                    },
                    {
                        question: "What is the correct passive form of: 'Someone stole my wallet.'?",
                        options: [
                            "A. My wallet was stolen by someone.",
                            "B. My wallet is stolen by someone.",
                            "C. My wallet has been stolen by someone.",
                            "D. My wallet had been stolen by someone.",
                            "E. My wallet will be stolen by someone."
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'My wallet was stolen by someone.'. The active sentence is in simple past tense ('stole'), so the passive should be 'was/were + past participle'."
                    },
                    {
                        question: "Which sentence correctly uses the third conditional?",
                        options: [
                            "A. If I study, I will pass the exam.",
                            "B. If I studied, I would pass the exam.",
                            "C. If I had studied, I would have passed the exam.",
                            "D. If I study, I would pass the exam.",
                            "E. If I had studied, I will pass the exam."
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'If I had studied, I would have passed the exam.'. The third conditional is used for hypothetical situations in the past (if + past perfect, would have + past participle)."
                    },
                    {
                        question: "What is the correct reported speech for: 'She said, \"I am going to the market.\"'?",
                        options: [
                            "A. She said that she is going to the market.",
                            "B. She said that she was going to the market.",
                            "C. She said that she has been going to the market.",
                            "D. She said that she will be going to the market.",
                            "E. She said that she goes to the market."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'She said that she was going to the market.'. When reporting speech, present continuous ('am going') changes to past continuous ('was going')."
                    },
                    {
                        question: "Which sentence uses 'despite' correctly?",
                        options: [
                            "A. Despite it was raining, we went out.",
                            "B. Despite of the rain, we went out.",
                            "C. Despite the rain, we went out.",
                            "D. Despite to the rain, we went out.",
                            "E. Despite raining, we went out."
                        ],
                        correctAnswer: 2,
                        explanation: "The correct answer is 'Despite the rain, we went out.'. 'Despite' is followed directly by a noun phrase ('the rain'), not by 'of' or a clause."
                    },
                    {
                        question: "What is the correct form of the verb in this sentence: 'Neither John nor his friends _____ going to the party.'?",
                        options: [
                            "A. is",
                            "B. are",
                            "C. was",
                            "D. be",
                            "E. has"
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'are'. With 'neither...nor', the verb agrees with the noun closest to it ('friends' is plural, so we use 'are')."
                    },
                    {
                        question: "Which sentence correctly uses an inversion for emphasis?",
                        options: [
                            "A. Never I have seen such a beautiful sunset.",
                            "B. Never have I seen such a beautiful sunset.",
                            "C. Never I seen have such a beautiful sunset.",
                            "D. Never I have seen such a beautiful sunset have.",
                            "E. Never seen I have such a beautiful sunset."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'Never have I seen such a beautiful sunset.'. When beginning with a negative adverb like 'never', we invert the subject and auxiliary verb."
                    },
                    {
                        question: "What is the correct phrasal verb to complete this sentence: 'Please _____ your shoes before entering the house.'?",
                        options: [
                            "A. take off",
                            "B. take on",
                            "C. take up",
                            "D. take in",
                            "E. take over"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'take off'. 'Take off' means to remove (clothing, shoes, etc.)."
                    },
                    {
                        question: "Which sentence correctly uses a defining relative clause?",
                        options: [
                            "A. The man, who lives next door, is a doctor.",
                            "B. The man who lives next door is a doctor.",
                            "C. The man, that lives next door, is a doctor.",
                            "D. The man which lives next door is a doctor.",
                            "E. The man he lives next door is a doctor."
                        ],
                        correctAnswer: 1,
                        explanation: "The correct answer is 'The man who lives next door is a doctor.'. This is a defining relative clause (no commas) that identifies which man we're talking about."
                    },
                    {
                        question: "What is the correct preposition to complete this sentence: 'I'm not very good _____ math.'?",
                        options: [
                            "A. at",
                            "B. in",
                            "C. on",
                            "D. for",
                            "E. with"
                        ],
                        correctAnswer: 0,
                        explanation: "The correct answer is 'at'. The correct preposition with 'good' in this context is 'at' (good at something)."
                    },
                    {
                question: "Read the following passage carefully and answer the question:\n\n'The rapid advancement of artificial intelligence has sparked intense debate among ethicists. While proponents argue that AI can solve complex problems and improve efficiency, critics warn of potential job displacement and loss of human autonomy. The Turing Test, developed by Alan Turing in 1950, remains a benchmark for machine intelligence, though some contemporary researchers argue it's become obsolete in the age of neural networks.'\n\nWhat is the main argument presented by critics of AI in this passage?",
                options: [
                    "A. AI is incapable of passing the Turing Test",
                    "B. AI may lead to unemployment and reduced human control",
                    "C. Neural networks have made the Turing Test irrelevant",
                    "D. AI is primarily beneficial for solving complex problems",
                    "E. Alan Turing's work is no longer applicable today"
                ],
                correctAnswer: 1,
                explanation: "The passage clearly states that critics warn of 'potential job displacement and loss of human autonomy,' which corresponds to option B about unemployment and reduced human control."
            },
            {
                question: "Which of the following sentences contains a subjunctive mood correctly used to express a hypothetical situation?",
                options: [
                    "A. If I was you, I would apologize immediately.",
                    "B. She acts like she was the queen of England.",
                    "C. I wish I were more knowledgeable about quantum physics.",
                    "D. He talks as if he is an expert in everything.",
                    "E. They behave like they was the owners of the company."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses the subjunctive mood 'I were' to express a hypothetical, contrary-to-fact situation. The subjunctive requires 'were' rather than 'was' for all subjects in hypothetical situations."
            },
            {
                question: "Identify the rhetorical device used in the following sentence: 'The city slept while the criminals prowled the streets like hungry wolves.'",
                options: [
                    "A. Synecdoche",
                    "B. Personification",
                    "C. Litotes",
                    "D. Anaphora",
                    "E. Zeugma"
                ],
                correctAnswer: 1,
                explanation: "The sentence uses personification by attributing the human quality of sleeping to the city. The comparison of criminals to wolves is a separate simile, not the primary rhetorical device in question."
            },
            {
                question: "Read the following passage and answer the question:\n\n'Postmodern literature often rejects the notion of absolute meaning, instead embracing fragmentation and intertextuality. Works like James Joyce's Ulysses or Thomas Pynchon's Gravity's Rainbow exemplify this tendency through their non-linear narratives and dense allusion to other texts.'\n\nBased on the passage, which characteristic is NOT typical of postmodern literature?",
                options: [
                    "A. Linear storytelling",
                    "B. Intertextual references",
                    "C. Fragmented structure",
                    "D. Rejection of absolute meaning",
                    "E. Complex narrative techniques"
                ],
                correctAnswer: 0,
                explanation: "The passage mentions that postmodern literature often has 'non-linear narratives,' making linear storytelling (option A) uncharacteristic of the genre. All other options are mentioned as typical features."
            },
            {
                question: "Which of the following sentences demonstrates proper use of the passive voice in an academic context?",
                options: [
                    "A. The researchers discovered a new species in the Amazon.",
                    "B. They will publish the findings in a prestigious journal.",
                    "C. A new species was discovered in the Amazon by researchers.",
                    "D. We have analyzed the data thoroughly.",
                    "E. You can see the results in Table 3."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses the passive voice ('was discovered') which is often preferred in academic writing to maintain objectivity. The agent ('by researchers') is included but not emphasized."
            },
            {
                question: "Analyze the following sentence and identify the grammatical error: 'Neither the students nor the teacher were aware of the schedule change that was announced yesterday.'",
                options: [
                    "A. Incorrect use of 'neither...nor' construction",
                    "B. Subject-verb agreement error",
                    "C. Misplaced modifier",
                    "D. Improper tense sequence",
                    "E. No error exists in the sentence"
                ],
                correctAnswer: 4,
                explanation: "The sentence contains no grammatical errors. The verb 'were' correctly agrees with the closer subject 'teacher' in the 'neither...nor' construction, and all other elements are properly used."
            },
            {
                question: "Which of the following excerpts from Shakespeare's plays best exemplifies the use of dramatic irony?",
                options: [
                    "A. 'To be, or not to be: that is the question' (Hamlet)",
                    "B. 'Romeo, Romeo, wherefore art thou Romeo?' (Romeo and Juliet)",
                    "C. 'All the world's a stage, and all the men and women merely players' (As You Like It)",
                    "D. 'Et tu, Brute?' (Julius Caesar)",
                    "E. 'Fair is foul, and foul is fair' (Macbeth)"
                ],
                correctAnswer: 1,
                explanation: "Option B demonstrates dramatic irony because Juliet is unaware that Romeo is listening nearby, while the audience knows he is present. This creates a gap between what the character knows and what the audience knows."
            },
            {
                question: "Read the poem excerpt and answer the question:\n\n'The woods are lovely, dark and deep,\nBut I have promises to keep,\nAnd miles to go before I sleep,\nAnd miles to go before I sleep.'\n\n(Robert Frost, 'Stopping by Woods on a Snowy Evening')\n\nWhat literary device is prominently used in the final two lines?",
                options: [
                    "A. Metaphor",
                    "B. Alliteration",
                    "C. Repetition",
                    "D. Onomatopoeia",
                    "E. Hyperbole"
                ],
                correctAnswer: 2,
                explanation: "The final two lines use repetition, where the same line is repeated for emphasis. This technique reinforces the speaker's sense of obligation and the journey ahead."
            },
            {
                question: "Which of the following sentences contains a dangling modifier?",
                options: [
                    "A. Running quickly, the finish line approached rapidly.",
                    "B. After studying all night, the exam seemed easier.",
                    "C. To improve your writing, practice is essential.",
                    "D. Having finished the assignment, the TV was turned on.",
                    "E. All of the above contain dangling modifiers"
                ],
                correctAnswer: 4,
                explanation: "All options contain dangling modifiers where the modifying phrase doesn't logically connect to the subject of the main clause. In each case, the implied subject of the modifier doesn't match the actual subject of the sentence."
            },
            {
                question: "Analyze the following complex sentence and identify its structure: 'Although climate change poses significant threats to biodiversity, many species have demonstrated remarkable adaptability, which gives scientists hope for ecosystem resilience.'",
                options: [
                    "A. Compound-complex sentence with one independent and two dependent clauses",
                    "B. Complex sentence with one independent and two dependent clauses",
                    "C. Compound sentence with two independent clauses",
                    "D. Simple sentence with compound predicates",
                    "E. Complex sentence with two independent clauses"
                ],
                correctAnswer: 1,
                explanation: "The sentence is complex (one independent clause: 'many species have demonstrated remarkable adaptability') with two dependent clauses: the 'Although' clause and the 'which' clause. It's not compound because there's only one independent clause."
            },
		{
                question: "Read the following passage and answer the question:\n\n'The dichotomy between nature and nurture in psychological development has long been debated. Contemporary research suggests epigenetic mechanisms may mediate this relationship, with environmental factors influencing gene expression without altering the DNA sequence itself.'\n\nWhat is the primary focus of this passage?",
                options: [
                    "A. The complete dominance of genetic factors in development",
                    "B. The irrelevance of environmental influences",
                    "C. The interaction between genes and environment",
                    "D. The superiority of nurture over nature",
                    "E. The static nature of genetic expression"
                ],
                correctAnswer: 2,
                explanation: "The passage discusses how epigenetic mechanisms mediate the relationship between nature and nurture, focusing on their interaction rather than dominance of one over the other."
            },
            {
                question: "Which of the following sentences demonstrates the correct use of the past perfect continuous tense?",
                options: [
                    "A. She had been studying for hours when the power went out.",
                    "B. They were eating dinner when the phone rang.",
                    "C. I have been working here since 2010.",
                    "D. We will be traveling to Japan next month.",
                    "E. He is being interviewed for the position."
                ],
                correctAnswer: 0,
                explanation: "Option A correctly uses the past perfect continuous ('had been studying') to describe an ongoing action that was interrupted by another past action ('the power went out')."
            },
            {
                question: "Identify the literary device in: 'The wind whispered secrets through the ancient trees.'",
                options: [
                    "A. Metaphor",
                    "B. Simile",
                    "C. Personification",
                    "D. Hyperbole",
                    "E. Allusion"
                ],
                correctAnswer: 2,
                explanation: "The sentence uses personification by giving the wind the human ability to whisper secrets."
            },
            {
                question: "Which sentence contains a restrictive clause essential to the meaning?",
                options: [
                    "A. My brother, who lives in Jakarta, is visiting next week.",
                    "B. The book that won the Pulitzer Prize is on sale.",
                    "C. Paris, where we spent our honeymoon, is beautiful.",
                    "D. Dr. Smith, whom you met yesterday, will chair the meeting.",
                    "E. The Pacific Ocean, which is the largest, borders California."
                ],
                correctAnswer: 1,
                explanation: "Option B contains a restrictive clause ('that won the Pulitzer Prize') essential to identifying which book is being discussed."
            },
            {
                question: "What is the tone of this passage?\n\n'The relentless march of deforestation continues unabated, with ancient ecosystems falling victim to human shortsightedness and greed.'",
                options: [
                    "A. Neutral and objective",
                    "B. Humorous and lighthearted",
                    "C. Pessimistic and critical",
                    "D. Nostalgic and sentimental",
                    "E. Optimistic and hopeful"
                ],
                correctAnswer: 2,
                explanation: "Words like 'relentless', 'unabated', 'victim', 'shortsightedness', and 'greed' create a pessimistic and critical tone."
            },
            {
                question: "Which of these sentences is grammatically incorrect?",
                options: [
                    "A. The data suggests a significant correlation.",
                    "B. Neither the manager nor the employees were satisfied.",
                    "C. Each of the participants have completed the survey.",
                    "D. The committee members disagree about the proposal.",
                    "E. Mathematics is his strongest subject."
                ],
                correctAnswer: 2,
                explanation: "Option C is incorrect because 'each' is singular and requires 'has' instead of 'have'."
            },
            {
                question: "What rhetorical strategy is used in: 'Ask not what your country can do for you; ask what you can do for your country.'",
                options: [
                    "A. Anaphora",
                    "B. Chiasmus",
                    "C. Litotes",
                    "D. Metonymy",
                    "E. Synecdoche"
                ],
                correctAnswer: 1,
                explanation: "This is chiasmus - a rhetorical device where words or concepts are repeated in reverse order."
            },
            {
                question: "Which sentence demonstrates proper parallel structure?",
                options: [
                    "A. She likes hiking, swimming, and to ride bicycles.",
                    "B. The project requires creativity, patience, and being organized.",
                    "C. He excels at writing, editing, and public speaking.",
                    "D. They discussed the problem, analyzed solutions, and implementing changes.",
                    "E. We need to plan carefully, work efficiently, and finishing on time."
                ],
                correctAnswer: 2,
                explanation: "Option C maintains parallel structure with all gerunds: writing, editing, and public speaking."
            },
            {
                question: "What is the primary purpose of this passage?\n\n'While some argue standardized testing measures student achievement, critics contend these assessments fail to capture creativity, critical thinking, or real-world problem-solving skills.'",
                options: [
                    "A. To advocate for more standardized testing",
                    "B. To present opposing views on standardized testing",
                    "C. To explain how to improve test scores",
                    "D. To describe the history of educational assessment",
                    "E. To praise the objectivity of standardized tests"
                ],
                correctAnswer: 1,
                explanation: "The passage presents both sides of the standardized testing debate without advocating for either position."
            },
            {
                question: "Which sentence uses subordination correctly?",
                options: [
                    "A. Because it was raining, we stayed indoors.",
                    "B. The sun was shining and the birds were singing.",
                    "C. She finished her work, then she went home.",
                    "D. First preheat the oven, next prepare the ingredients.",
                    "E. They wanted to travel but couldn't afford it."
                ],
                correctAnswer: 0,
                explanation: "Option A correctly uses a subordinate clause ('Because it was raining') with an independent clause ('we stayed indoors')."
            },
		{
                question: "Analyze the following sentence: 'Had the authorities heeded the warnings, the catastrophe might have been averted.' What type of conditional is this?",
                options: [
                    "A. Zero conditional",
                    "B. First conditional",
                    "C. Second conditional",
                    "D. Third conditional",
                    "E. Mixed conditional"
                ],
                correctAnswer: 3,
                explanation: "This is a third conditional sentence, which describes a hypothetical situation in the past ('Had the authorities heeded') and its possible consequence ('the catastrophe might have been averted')."
            },
            {
                question: "Which of the following excerpts from Shakespeare best illustrates the use of iambic pentameter?",
                options: [
                    "A. 'To be, or not to be: that is the question'",
                    "B. 'O! she doth teach the torches to burn bright'",
                    "C. 'Double, double toil and trouble'",
                    "D. 'All the world's a stage'",
                    "E. 'Fair is foul, and foul is fair'"
                ],
                correctAnswer: 0,
                explanation: "Option A perfectly demonstrates iambic pentameter with its ten-syllable, unstressed-stressed pattern: 'To BE or NOT to BE that IS the QUEST-ion' (the -ion is often elided)."
            },
            {
                question: "Read the passage and answer:\n\n'The anthropologist's ethnographic study revealed that the indigenous community's cosmovision fundamentally challenged Western epistemological paradigms, particularly in its non-dualistic conception of nature and culture.'\n\nWhat does 'cosmovision' most likely mean in this context?",
                options: [
                    "A. Astronomical knowledge",
                    "B. Worldview or philosophy of life",
                    "C. Religious rituals",
                    "D. Political system",
                    "E. Economic practices"
                ],
                correctAnswer: 1,
                explanation: "The term 'cosmovision' refers to a comprehensive worldview or philosophy that encompasses a culture's understanding of the universe and their place in it, as evidenced by its contrast with Western paradigms."
            },
            {
                question: "Which sentence demonstrates the correct use of the subjunctive mood in a formal recommendation?",
                options: [
                    "A. I suggest that he goes to the doctor immediately.",
                    "B. It's essential that she goes to the meeting.",
                    "C. We demand that the committee reconsider its decision.",
                    "D. They insisted that we are punctual.",
                    "E. The rule requires that all students are in uniform."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses the subjunctive form 'reconsider' (base form) after 'demand that'. The other options incorrectly use indicative forms ('goes', 'are')."
            },
            {
                question: "Identify the syntactic function of the underlined phrase:\n\n'Considering the economic downturn, the board decided to postpone the expansion plans.'",
                options: [
                    "A. Adverbial clause of time",
                    "B. Participial phrase modifying 'board'",
                    "C. Absolute phrase providing context",
                    "D. Appositive phrase",
                    "E. Gerund phrase as subject"
                ],
                correctAnswer: 2,
                explanation: "The phrase 'Considering the economic downturn' is an absolute phrase that modifies the entire main clause by providing contextual information, not just the subject."
            },
            {
                question: "Which of these sentences contains a cleft construction?",
                options: [
                    "A. What surprised me was his abrupt resignation.",
                    "B. She has been working here since graduation.",
                    "C. The committee will announce its decision tomorrow.",
                    "D. Having finished the report, he submitted it immediately.",
                    "E. They were informed about the policy change."
                ],
                correctAnswer: 0,
                explanation: "Option A contains a cleft sentence ('What surprised me was...') which divides information into two parts to emphasize specific elements, in this case 'his abrupt resignation'."
            },
            {
                question: "Analyze this sentence from an academic text:\n\n'Notwithstanding the methodological limitations enumerated above, the study's findings contribute substantially to the extant literature on cognitive development.'\n\nWhat is the function of 'Notwithstanding' in this context?",
                options: [
                    "A. To introduce a contrasting idea",
                    "B. To indicate cause and effect",
                    "C. To provide examples",
                    "D. To summarize previous points",
                    "E. To emphasize similarity"
                ],
                correctAnswer: 0,
                explanation: "'Notwithstanding' functions as a concessive transitional device, introducing a statement that contrasts with or opposes the previously mentioned limitations."
            },
            {
                question: "Which literary work exemplifies stream-of-consciousness narrative technique?",
                options: [
                    "A. George Orwell's 1984",
                    "B. James Joyce's Ulysses",
                    "C. Jane Austen's Pride and Prejudice",
                    "D. Ernest Hemingway's The Old Man and the Sea",
                    "E. J.R.R. Tolkien's The Lord of the Rings"
                ],
                correctAnswer: 1,
                explanation: "James Joyce's Ulysses is a prime example of stream-of-consciousness technique, attempting to portray the continuous flow of characters' thoughts and feelings."
            },
            {
                question: "What rhetorical purpose does the parallel structure serve in this passage?\n\n'We shall fight on the beaches, we shall fight on the landing grounds, we shall fight in the fields and in the streets, we shall fight in the hills...'",
                options: [
                    "A. To show chronological sequence",
                    "B. To create emotional intensity and determination",
                    "C. To compare different battle strategies",
                    "D. To introduce counterarguments",
                    "E. To provide statistical evidence"
                ],
                correctAnswer: 1,
                explanation: "The parallel structure ('we shall fight...') builds rhythmic intensity and emotional power, emphasizing relentless determination, characteristic of Churchill's wartime speeches."
            },
            {
                question: "Which analysis correctly identifies the metrical pattern in this line from Keats: 'My heart aches, and a drowsy numbness pains'?",
                options: [
                    "A. Iambic tetrameter with initial trochee",
                    "B. Iambic pentameter with spondaic substitution",
                    "C. Trochaic pentameter with iambic substitution",
                    "D. Anapestic trimeter with dactylic variation",
                    "E. Dactylic hexameter with spondaic foot"
                ],
                correctAnswer: 1,
                explanation: "The line is predominantly iambic pentameter (five feet of unstressed-stressed syllables) with a spondaic substitution (two stressed syllables) in 'heart aches'."
            },
		 {
                question: "Which of the following sentences contains a misplaced modifier?",
                options: [
                    "A. Covered in chocolate, the children devoured the cookies.",
                    "B. The professor explained the theory using simple diagrams.",
                    "C. Having finished the exam, the students left the room.",
                    "D. She served sandwiches to the children on paper plates.",
                    "E. The team celebrated their victory with great enthusiasm."
                ],
                correctAnswer: 3,
                explanation: "Option D contains a misplaced modifier suggesting the children were on paper plates rather than the sandwiches. It should be: 'She served the children sandwiches on paper plates.'"
            },
            {
                question: "Identify the rhetorical device in: 'The pen is mightier than the sword.'",
                options: [
                    "A. Simile",
                    "B. Metaphor",
                    "C. Metonymy",
                    "D. Synecdoche",
                    "E. Hyperbole"
                ],
                correctAnswer: 2,
                explanation: "This is metonymy - using 'pen' to represent writing/diplomacy and 'sword' to represent military force, where associated concepts are substituted for the things themselves."
            },
            {
                question: "Which sentence demonstrates the correct use of the future perfect continuous tense?",
                options: [
                    "A. By next year, I will be working here for a decade.",
                    "B. She will have been studying medicine for six years by graduation.",
                    "C. They will complete the project by Friday.",
                    "D. We are going to visit Paris next summer.",
                    "E. He has been waiting since morning."
                ],
                correctAnswer: 1,
                explanation: "Option B correctly uses future perfect continuous ('will have been studying') to emphasize the duration of an action up to a specific future time ('by graduation')."
            },
            {
                question: "Read the passage and answer:\n\n'The Victorian novel, with its omniscient narrators and moral didacticism, gave way to modernist experimentation characterized by fragmented perspectives and psychological depth.'\n\nWhat is the primary contrast being made?",
                options: [
                    "A. Length of novels then and now",
                    "B. Changing narrative techniques",
                    "C. Reader preferences across eras",
                    "D. Publication methods",
                    "E. Character development approaches"
                ],
                correctAnswer: 1,
                explanation: "The passage contrasts traditional Victorian narrative style ('omniscient narrators') with modernist innovations ('fragmented perspectives'), focusing on changing narrative techniques."
            },
            {
                question: "Which of these sentences violates subject-verb agreement rules for collective nouns?",
                options: [
                    "A. The committee has reached its decision.",
                    "B. The jury are divided in their opinions.",
                    "C. The team is celebrating its victory.",
                    "D. The government has announced new policies.",
                    "E. The class has completed its assignment."
                ],
                correctAnswer: 1,
                explanation: "Option B incorrectly uses plural verb 'are' with collective noun 'jury' when referring to it as a single unit. Either 'is' should be used, or the sentence rephrased as 'jury members are'."
            },
            {
                question: "What is the function of the underlined clause in:\n\n'What astonished the critics was the novel's unconventional structure.'",
                options: [
                    "A. Relative clause",
                    "B. Noun clause as subject",
                    "C. Adverbial clause of reason",
                    "D. Adjective clause",
                    "E. Independent clause"
                ],
                correctAnswer: 1,
                explanation: "The underlined portion 'What astonished the critics' functions as a noun clause serving as the subject of the sentence, with 'was' as the linking verb."
            },
            {
                question: "Which literary period is associated with these characteristics: emphasis on emotion, nature, individualism, and the supernatural?",
                options: [
                    "A. Renaissance",
                    "B. Enlightenment",
                    "C. Romanticism",
                    "D. Realism",
                    "E. Postmodernism"
                ],
                correctAnswer: 2,
                explanation: "These are hallmark characteristics of Romanticism, which emerged in the late 18th century as a reaction against Enlightenment rationalism."
            },
            {
                question: "Analyze the sentence structure:\n\n'Not only did the experiment fail to prove the hypothesis, but it also raised new questions that challenged fundamental assumptions.'",
                options: [
                    "A. Simple sentence with compound predicates",
                    "B. Compound sentence with coordinating conjunction",
                    "C. Complex sentence with correlative conjunctions",
                    "D. Compound-complex sentence",
                    "E. Complex sentence with subordinate clause"
                ],
                correctAnswer: 3,
                explanation: "This is a compound-complex sentence containing two independent clauses joined by 'but' and a dependent relative clause ('that challenged...'). The correlative 'not only...but also' connects the clauses."
            },
            {
                question: "Which of these words would best complete the following analogy:\n\nEPHEMERAL : TRANSIENT :: ______ : OBSCURE",
                options: [
                    "A. Lucid",
                    "B. Abstruse",
                    "C. Manifest",
                    "D. Transparent",
                    "E. Evident"
                ],
                correctAnswer: 1,
                explanation: "The analogy shows synonym relationship. 'Ephemeral' means 'transient', so we need a synonym for 'obscure'. 'Abstruse' means difficult to understand, matching this relationship."
            },
            {
                question: "What grammatical mood is used in:\n\n'Be it resolved that all members shall contribute equally.'",
                options: [
                    "A. Indicative",
                    "B. Imperative",
                    "C. Subjunctive",
                    "D. Conditional",
                    "E. Interrogative"
                ],
                correctAnswer: 2,
                explanation: "This formal resolution uses the subjunctive mood ('Be it resolved') to express a hypothetical or declarative statement, common in legal and parliamentary language."
            },
		{
                question: "Which of the following sentences demonstrates the correct use of an elliptical construction?",
                options: [
                    "A. John can play the piano, and Mary can play the violin.",
                    "B. Some students went to the museum, others went to the library.",
                    "C. She likes coffee; I like tea.",
                    "D. The team worked hard, and they won the championship.",
                    "E. After finishing his work, Tom went home."
                ],
                correctAnswer: 1,
                explanation: "Option B correctly uses an elliptical construction by omitting the verb 'went' in the second clause ('others [went] to the library'), which is understood from the context."
            },
            {
                question: "Identify the figure of speech in: 'The city was a furnace under the summer sun.'",
                options: [
                    "A. Simile",
                    "B. Metaphor",
                    "C. Personification",
                    "D. Hyperbole",
                    "E. Synecdoche"
                ],
                correctAnswer: 1,
                explanation: "This is a metaphor - a direct comparison between the city and a furnace without using 'like' or 'as', suggesting extreme heat."
            },
            {
                question: "Which sentence contains a dangling participle?",
                options: [
                    "A. Running down the street, the dog chased the ball.",
                    "B. Having finished the assignment, the student submitted it.",
                    "C. The book, written in 1920, remains popular today.",
                    "D. Broken by the storm, the window needed replacement.",
                    "E. While eating dinner, the phone rang."
                ],
                correctAnswer: 4,
                explanation: "Option E contains a dangling participle as the phrase 'While eating dinner' doesn't logically modify the subject 'the phone'. It implies the phone was eating dinner."
            },
            {
                question: "Read the passage and answer:\n\n'The postcolonial novel often engages in what theorists term 'writing back' to the colonial center, subverting traditional narratives through alternative perspectives and linguistic experimentation.'\n\nWhat does 'writing back' refer to in this context?",
                options: [
                    "A. Literally responding to letters from colonizers",
                    "B. Correcting grammatical errors in colonial texts",
                    "C. Challenging colonial narratives through literature",
                    "D. Translating native languages into English",
                    "E. Preserving oral storytelling traditions"
                ],
                correctAnswer: 2,
                explanation: "'Writing back' refers to postcolonial authors challenging and subverting colonial narratives through their literary works, offering alternative perspectives."
            },
            {
                question: "Which of these sentences uses the passive voice appropriately in academic writing?",
                options: [
                    "A. The experiment was conducted over three months.",
                    "B. Researchers discovered a new species last year.",
                    "C. We analyzed the data using SPSS software.",
                    "D. You can see the results in Table 1.",
                    "E. I believe this theory explains the phenomenon."
                ],
                correctAnswer: 0,
                explanation: "Option A appropriately uses passive voice ('was conducted') which is preferred in academic writing to maintain objectivity and focus on the action rather than the actor."
            },
            {
                question: "What is the function of the underlined phrase in:\n\n'His argument being fundamentally flawed, the committee rejected the proposal.'",
                options: [
                    "A. Absolute phrase providing reason",
                    "B. Participial phrase modifying 'committee'",
                    "C. Appositive phrase",
                    "D. Gerund phrase as subject",
                    "E. Infinitive phrase showing purpose"
                ],
                correctAnswer: 0,
                explanation: "The underlined portion is an absolute phrase that modifies the entire main clause by providing the reason for the committee's decision."
            },
            {
                question: "Which literary device is primarily used in this excerpt:\n\n'The wind howled in protest as the storm approached the vulnerable coastline.'",
                options: [
                    "A. Alliteration",
                    "B. Onomatopoeia",
                    "C. Personification",
                    "D. Oxymoron",
                    "E. Paradox"
                ],
                correctAnswer: 2,
                explanation: "The sentence uses personification by giving the wind human characteristics ('howled in protest')."
            },
            {
                question: "Which sentence correctly uses a subjunctive mood for a hypothetical situation?",
                options: [
                    "A. If I was rich, I would travel the world.",
                    "B. I wish I was taller for basketball.",
                    "C. If I were you, I'd reconsider that decision.",
                    "D. She acts like she was the boss.",
                    "E. He talks as if he was an expert."
                ],
                correctAnswer: 2,
                explanation: "Option C correctly uses the subjunctive mood 'were' for the hypothetical situation of being in someone else's position, regardless of the subject 'I'."
            },
            {
                question: "What type of conditional is this sentence:\n\n'Should you require any assistance, please don't hesitate to contact us.'",
                options: [
                    "A. Zero conditional",
                    "B. First conditional",
                    "C. Second conditional",
                    "D. Third conditional",
                    "E. Mixed conditional"
                ],
                correctAnswer: 1,
                explanation: "This is a first conditional in inverted form ('Should you' instead of 'If you should'), expressing a real possibility in the future."
            },
            {
                question: "Which analysis correctly describes the meter in this line from Shakespeare:\n\n'Shall I compare thee to a summer's day?'",
                options: [
                    "A. Trochaic pentameter",
                    "B. Iambic tetrameter",
                    "C. Iambic pentameter",
                    "D. Anapestic trimeter",
                    "E. Dactylic hexameter"
                ],
                correctAnswer: 2,
                explanation: "The line is perfect iambic pentameter: five feet of unstressed-stressed syllables: 'Shall I | compare | thee to | a sum | mer's day?'"
            }
                ]
            }
        };

        // Motivational messages based on score
        const MOTIVATIONAL_MESSAGES = {
            '90-100': 'Sempurna! Anda sangat luar biasa dalam menguasai materi Bahasa Inggris. Pertahankan prestasi ini.',
            '80-89': 'Hasil yang sangat baik! Anda telah menunjukkan pemahaman yang mendalam tentang Bahasa Inggris.',
            '70-79': 'Kerja bagus! Anda memiliki pemahaman yang baik tentang materi Bahasa Inggris ini.',
            '60-69': 'Hasil yang cukup baik. Tingkatkan lagi pemahaman Anda untuk hasil yang lebih baik.',
            '50-59': 'Anda sudah memahami dasar-dasarnya. Terus berlatih untuk meningkatkan kemampuan Bahasa Inggris.',
            '0-49': 'Jangan menyerah! Gunakan hasil ini sebagai motivasi untuk belajar Bahasa Inggris lebih giat lagi.'
        };
        
        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize particles.js for background
            particlesJS('particles-js', {
                "particles": {
                    "number": {
                        "value": 80,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": "#ffffff"
                    },
                    "shape": {
                        "type": "circle",
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                        "polygon": {
                            "nb_sides": 5
                        }
                    },
                    "opacity": {
                        "value": 0.5,
                        "random": false,
                        "anim": {
                            "enable": false,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 3,
                        "random": true,
                        "anim": {
                            "enable": false,
                            "speed": 40,
                            "size_min": 0.1,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": true,
                        "distance": 150,
                        "color": "#ffffff",
                        "opacity": 0.4,
                        "width": 1
                    },
                    "move": {
                        "enable": true,
                        "speed": 2,
                        "direction": "none",
                        "random": false,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": false,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": true,
                            "mode": "grab"
                        },
                        "onclick": {
                            "enable": true,
                            "mode": "push"
                        },
                        "resize": true
                    },
                    "modes": {
                        "grab": {
                            "distance": 140,
                            "line_linked": {
                                "opacity": 1
                            }
                        },
                        "bubble": {
                            "distance": 400,
                            "size": 40,
                            "duration": 2,
                            "opacity": 8,
                            "speed": 3
                        },
                        "repulse": {
                            "distance": 200,
                            "duration": 0.4
                        },
                        "push": {
                            "particles_nb": 4
                        },
                        "remove": {
                            "particles_nb": 2
                        }
                    }
                },
                "retina_detect": true
            });
            
            // Initialize celebration particles (hidden by default)
            particlesJS('celebration-particles', {
                "particles": {
                    "number": {
                        "value": 150,
                        "density": {
                            "enable": true,
                            "value_area": 800
                        }
                    },
                    "color": {
                        "value": ["#FF0000", "#00FF00", "#0000FF", "#FFFF00", "#FF00FF", "#00FFFF"]
                    },
                    "shape": {
                        "type": ["circle", "triangle", "star"],
                        "stroke": {
                            "width": 0,
                            "color": "#000000"
                        },
                        "polygon": {
                            "nb_sides": 5
                        }
                    },
                    "opacity": {
                        "value": 0.7,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 1,
                            "opacity_min": 0.1,
                            "sync": false
                        }
                    },
                    "size": {
                        "value": 5,
                        "random": true,
                        "anim": {
                            "enable": true,
                            "speed": 4,
                            "size_min": 0.3,
                            "sync": false
                        }
                    },
                    "line_linked": {
                        "enable": false
                    },
                    "move": {
                        "enable": true,
                        "speed": 6,
                        "direction": "none",
                        "random": true,
                        "straight": false,
                        "out_mode": "out",
                        "bounce": false,
                        "attract": {
                            "enable": false,
                            "rotateX": 600,
                            "rotateY": 1200
                        }
                    }
                },
                "interactivity": {
                    "detect_on": "canvas",
                    "events": {
                        "onhover": {
                            "enable": false
                        },
                        "onclick": {
                            "enable": false
                        },
                        "resize": true
                    }
                },
                "retina_detect": true
            });
            
            // Load admin settings
            loadAdminSettings();
            
            // Set greeting message from admin settings
            document.getElementById('greeting-text').textContent = adminSettings.greetingMessage;
            document.getElementById('admin-message').textContent = adminSettings.adminMessage;
            
            // Event listeners for buttons with sound
            document.querySelectorAll('button').forEach(button => {
                button.addEventListener('click', function() {
                    // Play button sound if not disabled
                    if (!this.disabled) {
                        buttonSound.currentTime = 0;
                        buttonSound.play().catch(e => console.log("Button sound prevented:", e));
                    }
                });
            });
            
            // Event listeners
            document.getElementById('login-btn').addEventListener('click', handleLogin);
            document.getElementById('agree-terms').addEventListener('change', toggleContinueButton);
            document.getElementById('continue-btn').addEventListener('click', showParticipantForm);
            
            // Status radio buttons
            document.querySelectorAll('input[name="status"]').forEach(radio => {
                radio.addEventListener('change', toggleParticipantFields);
            });
            
            // School level radio buttons
            document.querySelectorAll('input[name="level"]').forEach(radio => {
                radio.addEventListener('change', showGradeSelection);
            });
            
            document.getElementById('save-participant-btn').addEventListener('click', validateAndStartExam);
            document.getElementById('finish-exam-btn').addEventListener('click', finishExam);
            document.getElementById('skip-question-btn').addEventListener('click', skipQuestion);
            document.getElementById('unanswered-btn').addEventListener('click', showUnansweredQuestions);
            document.getElementById('print-certificate-btn').addEventListener('click', printCertificate);
            document.getElementById('retake-exam-btn').addEventListener('click', retakeExam);
            
            // Floating buttons
            document.getElementById('whatsapp-btn').addEventListener('click', contactAdmin);
            document.getElementById('admin-panel-btn').addEventListener('click', showAdminPanelModal);
            
            // Modal close buttons
            document.getElementById('close-admin-panel-modal').addEventListener('click', hideAdminPanelModal);
            document.getElementById('close-edit-participant-modal').addEventListener('click', hideEditParticipantModal);
            
            // Modal submit buttons
            document.getElementById('submit-admin-panel-code').addEventListener('click', submitAdminPanelCode);
            
            // Check form validity when fields change
            document.getElementById('fullname').addEventListener('input', function() {
                // Convert input to uppercase automatically
                this.value = this.value.toUpperCase();
                validateField(this, 'fullname-error', /^[A-Za-z ]+$/, "Nama lengkap harus diisi dan hanya boleh mengandung huruf");
                checkParticipantFormValidity();
            });
            
            document.getElementById('school-name').addEventListener('input', function() {
                validateField(this, 'school-error', /.+/, "Nama sekolah harus diisi");
                checkParticipantFormValidity();
            });
            
            document.getElementById('student-id').addEventListener('input', function() {
                validateField(this, 'nis-error', /^[0-9]+$/, "NIS harus diisi dan hanya boleh mengandung angka");
                checkParticipantFormValidity();
            });
            
            document.querySelectorAll('input[name="purpose"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('purpose-error').style.display = 'none';
                    document.getElementById('purpose-radio-group').classList.remove('radio-group-error');
                    checkParticipantFormValidity();
                });
            });
            
            document.querySelectorAll('input[name="level"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('level-error').style.display = 'none';
                    document.getElementById('level-radio-group').classList.remove('radio-group-error');
                    checkParticipantFormValidity();
                });
            });
            
            document.querySelectorAll('input[name="grade"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('grade-error').style.display = 'none';
                    checkParticipantFormValidity();
                });
            });
            
            document.querySelectorAll('input[name="subject"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('subject-error').style.display = 'none';
                    document.getElementById('subject-radio-group').classList.remove('radio-group-error');
                    checkParticipantFormValidity();
                });
            });

            // Admin panel toggle switches
            document.querySelectorAll('.toggle-switch input').forEach(toggle => {
                toggle.addEventListener('change', function() {
                    const statusElement = document.getElementById(`${this.id}-status`);
                    statusElement.textContent = this.checked ? 'Aktif' : 'Nonaktif';
                });
            });

            // Admin panel buttons
            document.getElementById('save-codes-btn').addEventListener('click', saveCodes);
            document.getElementById('save-content-btn').addEventListener('click', saveContent);
            document.getElementById('save-settings-btn').addEventListener('click', saveSettings);
            
            // Participant management buttons
            document.getElementById('select-all-participants').addEventListener('click', toggleSelectAllParticipants);
            document.getElementById('edit-selected-participants').addEventListener('click', editSelectedParticipants);
            document.getElementById('delete-selected-participants').addEventListener('click', deleteSelectedParticipants);
            document.getElementById('validate-certificate-btn').addEventListener('click', validateCertificate);
            document.getElementById('export-csv-btn').addEventListener('click', exportToCSV);
            document.getElementById('export-json-btn').addEventListener('click', exportToJSON);
            document.getElementById('export-excel-btn').addEventListener('click', exportToExcel);
            
            // Search functionality
            document.getElementById('participant-search').addEventListener('input', searchParticipants);
            
            // Edit participant form
            document.getElementById('save-edit-participant-btn').addEventListener('click', saveEditedParticipant);
            document.querySelectorAll('input[name="edit-status"]').forEach(radio => {
                radio.addEventListener('change', toggleEditParticipantFields);
            });
            document.querySelectorAll('input[name="edit-level"]').forEach(radio => {
                radio.addEventListener('change', showEditGradeSelection);
            });
            
            // Auto uppercase for edit fullname field
            document.getElementById('edit-fullname').addEventListener('input', function() {
                this.value = this.value.toUpperCase();
            });
        });
        
        // Functions
        function loadAdminSettings() {
            // Load exam duration
            document.getElementById('exam-duration').value = adminSettings.examDuration;
            
            // Load greeting message
            document.getElementById('greeting-message-input').value = adminSettings.greetingMessage;
            
            // Load admin message
            document.getElementById('admin-message-input').value = adminSettings.adminMessage;
            
            // Load chairman name
            document.getElementById('chairman-name').value = adminSettings.chairmanName;
            
            // Load subject toggle
            document.getElementById('toggle-english').checked = adminSettings.enabledSubjects["Bahasa Inggris"];
            document.getElementById('english-status').textContent = adminSettings.enabledSubjects["Bahasa Inggris"] ? 'Aktif' : 'Nonaktif';
        }
        
        function saveParticipantsData() {
            localStorage.setItem('pergunuParticipantsData', JSON.stringify(participantsData));
        }
        
        function saveAdminSettings() {
            localStorage.setItem('pergunuAdminSettings', JSON.stringify(adminSettings));
        }
        
        function handleLogin() {
            const loginCode = document.getElementById('login-code').value;
            
            if (loginCode === adminSettings.loginCode) {
                // Play opening sound
                openingSound.play().catch(e => console.log("Opening sound prevented:", e));
                
                // Hide welcome screen with slide out animation
                document.getElementById('welcome-screen').classList.add('slide-out');
                
                // Show terms screen after animation completes
                setTimeout(() => {
                    document.getElementById('welcome-screen').style.display = 'none';
                    document.getElementById('terms-screen').style.display = 'block';
                    document.getElementById('terms-screen').classList.add('slide-in');
                    currentScreen = 'terms';
                }, 500);
            } else {
                alert('Kode login salah. Silakan coba lagi.');
            }
        }
        
        function toggleContinueButton() {
            const agreeCheckbox = document.getElementById('agree-terms');
            document.getElementById('continue-btn').disabled = !agreeCheckbox.checked;
        }
        
        function showParticipantForm() {
            // Hide terms screen with slide out animation
            document.getElementById('terms-screen').classList.add('slide-out');
            
            // Show participant form after animation completes
            setTimeout(() => {
                document.getElementById('terms-screen').style.display = 'none';
                document.getElementById('participant-form').style.display = 'block';
                document.getElementById('participant-form').classList.add('slide-in');
                currentScreen = 'participant';
            }, 500);
        }
        
        function toggleParticipantFields() {
            // Only student status is available now
            document.getElementById('student-fields').style.display = 'block';
            checkParticipantFormValidity();
        }
        
        function showGradeSelection() {
            const level = document.querySelector('input[name="level"]:checked').value;
            const gradeOptions = document.getElementById('grade-options');
            
            // Clear previous options
            gradeOptions.innerHTML = '';
            
            // Add options based on level
            if (level === 'SD') {
                addGradeOption('grade-4', 'Kelas <span class="roman">IV</span>', '4');
                addGradeOption('grade-5', 'Kelas <span class="roman">V</span>', '5');
                addGradeOption('grade-6', 'Kelas <span class="roman">VI</span>', '6');
            } else if (level === 'SMP') {
                addGradeOption('grade-7', 'Kelas <span class="roman">VII</span>', '7');
                addGradeOption('grade-8', 'Kelas <span class="roman">VIII</span>', '8');
                addGradeOption('grade-9', 'Kelas <span class="roman">IX</span>', '9');
            } else if (level === 'SMA/SMK') {
                addGradeOption('grade-10', 'Kelas <span class="roman">X</span>', '10');
                addGradeOption('grade-11', 'Kelas <span class="roman">XI</span>', '11');
                addGradeOption('grade-12', 'Kelas <span class="roman">XII</span>', '12');
            }
            
            document.getElementById('grade-selection').style.display = 'block';
            checkParticipantFormValidity();
        }
        
        function addGradeOption(id, label, value) {
            const container = document.getElementById('grade-options');
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.id = id;
            radio.name = 'grade';
            radio.value = value;
            radio.className = 'radio-option';
            
            const radioLabel = document.createElement('label');
            radioLabel.htmlFor = id;
            radioLabel.className = 'radio-label';
            radioLabel.innerHTML = label;
            
            // Add event listener for grade selection
            radio.addEventListener('change', function() {
                document.getElementById('subject-selection').style.display = 'block';
                checkParticipantFormValidity();
            });
            
            container.appendChild(radio);
            container.appendChild(radioLabel);
        }
        
        function validateField(field, errorId, pattern, errorMessage) {
            const errorElement = document.getElementById(errorId);
            
            if (!field.value.trim() || !pattern.test(field.value.trim())) {
                field.classList.add('input-error');
                errorElement.textContent = errorMessage;
                errorElement.style.display = 'block';
                return false;
            } else {
                field.classList.remove('input-error');
                errorElement.style.display = 'none';
                return true;
            }
        }
        
        function checkParticipantFormValidity() {
            let isValid = true;
            
            // Validate fullname
            const fullname = document.getElementById('fullname');
            if (!validateField(fullname, 'fullname-error', /^[A-Za-z ]+$/, "Nama lengkap harus diisi dan hanya boleh mengandung huruf")) {
                isValid = false;
            }
            
            // Validate school name
            const schoolName = document.getElementById('school-name');
            if (!validateField(schoolName, 'school-error', /.+/, "Nama sekolah harus diisi")) {
                isValid = false;
            }
            
            // Validate student ID
            const studentId = document.getElementById('student-id');
            if (!validateField(studentId, 'nis-error', /^[0-9]+$/, "NIS harus diisi dan hanya boleh mengandung angka")) {
                isValid = false;
            }
            
            // Validate purpose
            if (!document.querySelector('input[name="purpose"]:checked')) {
                document.getElementById('purpose-error').style.display = 'block';
                document.getElementById('purpose-radio-group').classList.add('radio-group-error');
                isValid = false;
            }
            
            // Validate level
            if (!document.querySelector('input[name="level"]:checked')) {
                document.getElementById('level-error').style.display = 'block';
                document.getElementById('level-radio-group').classList.add('radio-group-error');
                isValid = false;
            }
            
            // Validate grade
            if (!document.querySelector('input[name="grade"]:checked')) {
                document.getElementById('grade-error').style.display = 'block';
                isValid = false;
            }
            
            // Validate subject
            if (!document.querySelector('input[name="subject"]:checked')) {
                document.getElementById('subject-error').style.display = 'block';
                document.getElementById('subject-radio-group').classList.add('radio-group-error');
                isValid = false;
            }
            
            document.getElementById('save-participant-btn').disabled = !isValid;
            return isValid;
        }
        
        function validateAndStartExam() {
            if (checkParticipantFormValidity()) {
                startExam();
            } else {
                // Show warning notification
                const warning = document.getElementById('form-warning');
                warning.style.display = 'block';
                
                // Hide after 5 seconds
                setTimeout(() => {
                    warning.style.display = 'none';
                }, 5000);
                
                // Scroll to first error
                const firstError = document.querySelector('.input-error, .radio-group-error');
                if (firstError) {
                    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
                }
            }
        }
        
        function startExam() {
            // Collect participant data
            participantData = {
                fullname: document.getElementById('fullname').value.trim(),
                status: 'pelajar',
                purpose: document.querySelector('input[name="purpose"]:checked')?.value,
                level: document.querySelector('input[name="level"]:checked')?.value,
                grade: document.querySelector('input[name="grade"]:checked')?.value,
                subject: document.querySelector('input[name="subject"]:checked')?.value,
                school: document.getElementById('school-name')?.value.trim(),
                studentId: document.getElementById('student-id')?.value.trim(),
                examDate: new Date().toISOString(),
                deviceInfo: getDeviceInfo()
            };
            
            // Load questions based on level - hanya Bahasa Inggris
            if (participantData.level && QUESTION_BANK[participantData.level]['Bahasa Inggris']) {
                // Acak urutan soal
                const originalQuestions = QUESTION_BANK[participantData.level]['Bahasa Inggris'];
                questions = shuffleArray(originalQuestions);
                
                // Simpan urutan soal yang diacak
                questionOrder = questions.map((_, index) => index);
            } else {
                // Default questions (SD)
                const originalQuestions = QUESTION_BANK['SD']['Bahasa Inggris'];
                questions = shuffleArray(originalQuestions);
                questionOrder = questions.map((_, index) => index);
            }
            
            // Initialize exam data
            examData = {
                startTime: new Date(),
                answered: 0,
                correct: 0,
                wrong: 0,
                unanswered: questions.length,
                answers: Array(questions.length).fill(null)
            };
            
            // Set exam time from admin settings
            examTimeLeft = adminSettings.examDuration * 60;
            
            // Hide participant form with slide out animation
            document.getElementById('participant-form').classList.add('slide-out');
            
            // Show exam screen after animation completes
            setTimeout(() => {
                document.getElementById('participant-form').style.display = 'none';
                document.getElementById('exam-screen').style.display = 'block';
                document.getElementById('exam-screen').classList.add('slide-in');
                currentScreen = 'exam';
                
                // Start timer
                startTimer();
                
                // Load first question
                loadQuestion(0);
            }, 500);
        }
        
        // Fungsi untuk mendapatkan informasi perangkat
        function getDeviceInfo() {
            const userAgent = navigator.userAgent;
            let deviceType = 'Desktop';
            
            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(userAgent)) {
                deviceType = 'Mobile';
            } else if (/Tablet|iPad/i.test(userAgent)) {
                deviceType = 'Tablet';
            }
            
            return {
                deviceType: deviceType,
                userAgent: userAgent,
                screenWidth: window.screen.width,
                screenHeight: window.screen.height,
                platform: navigator.platform,
                language: navigator.language
            };
        }
        
        // Fungsi untuk mengacak array (Fisher-Yates algorithm)
        function shuffleArray(array) {
            const newArray = [...array];
            for (let i = newArray.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
            }
            return newArray;
        }
        
        function startTimer() {
            // Update timer display immediately
            updateTimerDisplay();
            
            // Start timer interval
            examTimer = setInterval(function() {
                examTimeLeft--;
                updateTimerDisplay();
                
                // Check if time is up
                if (examTimeLeft <= 0) {
                    clearInterval(examTimer);
                    finishExam();
                }
                
                // Show warning when 10 minutes left
                if (examTimeLeft === 600) { // 10 minutes = 600 seconds
                    showTimeWarning();
                }
                
                // Hide warning when 1 minute left
                if (examTimeLeft === 60) {
                    hideTimeWarning();
                }
            }, 1000);
        }
        
        function updateTimerDisplay() {
            const hours = Math.floor(examTimeLeft / 3600);
            const minutes = Math.floor((examTimeLeft % 3600) / 60);
            const seconds = examTimeLeft % 60;
            
            const timerElement = document.getElementById('exam-timer');
            timerElement.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            
            // Change style based on remaining time
            if (examTimeLeft <= 600) { // 10 minutes or less
                timerElement.classList.add('timer-warning');
                
                if (examTimeLeft <= 60) { // 1 minute or less
                    timerElement.classList.remove('timer-warning');
                    timerElement.classList.add('timer-danger');
                }
            } else {
                timerElement.classList.remove('timer-warning', 'timer-danger');
            }
        }
        
        function showTimeWarning() {
            const notification = document.getElementById('time-warning');
            notification.style.display = 'block';
            
            // Auto hide after 9 minutes (540 seconds)
            setTimeout(() => {
                notification.style.display = 'none';
            }, 540 * 1000);
        }
        
        function hideTimeWarning() {
            document.getElementById('time-warning').style.display = 'none';
        }
        
        function loadQuestion(index) {
            if (index < 0 || index >= questions.length) return;
            
            currentQuestionIndex = index;
            const question = questions[index];
            
            // Update question text (tampilkan nomor urut asli dari questionOrder)
            const originalQuestionNumber = questionOrder[index] + 1;
            document.getElementById('question-text').textContent = `Soal ${originalQuestionNumber}: ${question.question}`;
            
            // Clear previous image if exists
            const imageContainer = document.getElementById('question-image-container');
            imageContainer.innerHTML = '';
            
            // Add image if exists
            if (question.image) {
                const img = document.createElement('img');
                img.src = question.image;
                img.style.maxWidth = '100%';
                img.style.maxHeight = '200px';
                img.style.marginBottom = '15px';
                img.style.display = 'block';
                imageContainer.appendChild(img);
            }
            
            // Clear previous options
            const optionsContainer = document.getElementById('options-container');
            optionsContainer.innerHTML = '';
            
            // Add new options
            question.options.forEach((option, i) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                optionElement.textContent = option;
                
                // Check if this question was already answered
                if (examData.answers[index] !== null) {
                    if (examData.answers[index] === i) {
                        if (i === question.correctAnswer) {
                            optionElement.classList.add('correct');
                        } else {
                            optionElement.classList.add('incorrect');
                        }
                    } else if (i === question.correctAnswer) {
                        optionElement.classList.add('correct');
                    }
                    
                    // Show explanation if answered
                    document.getElementById('explanation-text').style.display = 'block';
                    document.getElementById('explanation-text').innerHTML = `<strong>Penjelasan:</strong> ${question.explanation}`;
                } else {
                    // Add click event for unanswered questions
                    optionElement.addEventListener('click', function() {
                        selectAnswer(index, i);
                    });
                }
                
                optionsContainer.appendChild(optionElement);
            });
            
            // Hide explanation if question not answered
            if (examData.answers[index] === null) {
                document.getElementById('explanation-text').style.display = 'none';
            }
        }
        
        function selectAnswer(questionIndex, answerIndex) {
            const question = questions[questionIndex];
            
            // Record answer
            examData.answers[questionIndex] = answerIndex;
            
            // Update counters
            examData.answered++;
            examData.unanswered--;
            
            if (answerIndex === question.correctAnswer) {
                examData.correct++;
                // Play correct answer sound
                correctAnswerSound.currentTime = 0;
                correctAnswerSound.play().catch(e => console.log("Correct answer sound prevented:", e));
            } else {
                examData.wrong++;
                // Play wrong answer sound
                wrongAnswerSound.currentTime = 0;
                wrongAnswerSound.play().catch(e => console.log("Wrong answer sound prevented:", e));
            }
            
            // Reload question to show result
            loadQuestion(questionIndex);
            
            // Auto move to next question after delay if not last question
            if (questionIndex < questions.length - 1) {
                setTimeout(() => {
                    loadQuestion(questionIndex + 1);
                }, 2000);
            }
        }
        
        function skipQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                loadQuestion(currentQuestionIndex + 1);
            }
        }
        
        function showUnansweredQuestions() {
            // Find first unanswered question
            const unansweredIndex = examData.answers.findIndex(answer => answer === null);
            
            if (unansweredIndex !== -1) {
                loadQuestion(unansweredIndex);
            } else {
                alert('Semua soal sudah dijawab.');
            }
        }
        
        async function finishExam() {
            clearInterval(examTimer);
            
            // Calculate unanswered questions
            examData.unanswered = examData.answers.filter(answer => answer === null).length;
            
            // Generate certificate code
            const certificateCode = generateUniqueCode();
            
            // Calculate score
            const score = Math.round((examData.correct / questions.length) * 100);
            
            // Add participant to data store
            const participantRecord = {
                ...participantData,
                score: score,
                examDate: new Date().toISOString(),
                certificateCode: certificateCode,
                answers: examData.answers,
                questions: questions.map((q, i) => ({
                    question: q.question,
                    selectedAnswer: examData.answers[i],
                    correctAnswer: q.correctAnswer,
                    explanation: q.explanation
                })),
                deviceInfo: participantData.deviceInfo,
                totalQuestions: questions.length,
                correctAnswers: examData.correct,
                wrongAnswers: examData.wrong,
                unanswered: examData.unanswered
            };
            
            // Simpan ke Google Sheets dan localStorage
            try {
                // First try to save to Google Sheets
                const saveResult = await saveToGoogleSheets(participantRecord);
                
                if (saveResult.success) {
                    // If successful, save to localStorage as well
                    participantsData.push(participantRecord);
                    saveParticipantsData();
                    
                    // Show results
                    showResults(participantRecord, certificateCode);
                } else {
                    // If Google Sheets fails, fallback to localStorage
                    console.error('Failed to save to Google Sheets:', saveResult.message);
                    saveToLocalStorage(participantRecord);
                    showResults(participantRecord, certificateCode);
                }
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                // Fallback to localStorage
                saveToLocalStorage(participantRecord);
                showResults(participantRecord, certificateCode);
            }
        }
        
        function showResults(participantRecord, certificateCode) {
            // Hide exam screen with slide out animation
            document.getElementById('exam-screen').classList.add('slide-out');
            
            // Show results screen after animation completes
            setTimeout(() => {
                document.getElementById('exam-screen').style.display = 'none';
                document.getElementById('results-screen').style.display = 'block';
                document.getElementById('results-screen').classList.add('slide-in');
                currentScreen = 'results';
                
                // Display results
                displayResults(participantRecord);
                
                // Generate certificate
                generateCertificate(certificateCode);
                
                // Show celebration particles
                showCelebration();
                
                // Play certificate sound (applause)
                certificateSound.currentTime = 0;
                certificateSound.play().catch(e => console.log("Certificate sound prevented:", e));
            }, 500);
        }

        // Fungsi untuk mengirim data ke Google Sheets
        async function saveToGoogleSheets(participantData) {
            const dataToSend = {
                action: 'saveParticipant',
                data: {
                    fullname: participantData.fullname,
                    status: participantData.status,
                    purpose: participantData.purpose,
                    level: participantData.level,
                    grade: participantData.grade,
                    subject: participantData.subject,
                    school: participantData.school,
                    studentId: participantData.studentId,
                    score: participantData.score,
                    certificateCode: participantData.certificateCode,
                    examDate: participantData.examDate,
                    deviceType: participantData.deviceInfo?.deviceType || 'Unknown',
                    totalQuestions: participantData.totalQuestions,
                    correctAnswers: participantData.correctAnswers,
                    wrongAnswers: participantData.wrongAnswers,
                    unanswered: participantData.unanswered
                }
            };

            try {
                const response = await fetch(GOOGLE_SCRIPT_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(dataToSend)
                });

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error saving to Google Sheets:', error);
                throw error;
            }
        }

        function saveToLocalStorage(participantData) {
            const participantRecord = {
                ...participantData,
                totalQuestions: questions.length,
                correctAnswers: examData.correct,
                wrongAnswers: examData.wrong,
                unanswered: examData.unanswered
            };
            
            participantsData.push(participantRecord);
            saveParticipantsData();
        }
            
        function displayResults(participantRecord) {
            document.getElementById('result-name').textContent = participantRecord.fullname;
            document.getElementById('result-status').textContent = 'Pelajar';
            document.getElementById('result-level').textContent = participantRecord.level || '-';
            document.getElementById('result-grade').textContent = participantRecord.grade ? `Kelas ${participantRecord.grade}` : '-';
            document.getElementById('result-subject').textContent = participantRecord.subject || '-';
            document.getElementById('total-questions').textContent = participantRecord.totalQuestions;
            document.getElementById('correct-answers').textContent = participantRecord.correctAnswers;
            document.getElementById('wrong-answers').textContent = participantRecord.wrongAnswers;
            document.getElementById('unanswered-questions').textContent = participantRecord.unanswered;
            
            // Calculate score (percentage)
            const score = Math.round((participantRecord.correctAnswers / participantRecord.totalQuestions) * 100);
            document.getElementById('exam-score').textContent = `${score}%`;
        }
        
        function generateCertificate(certificateCode) {
            const certificateContainer = document.getElementById('certificate-container');
            certificateContainer.innerHTML = '';
            
            // Calculate score
            const score = Math.round((examData.correct / questions.length) * 100);
            
            // Get current date
            const now = new Date();
            const dateString = now.toLocaleDateString('id-ID', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            }).replace(/\//g, '');
            
            // Get motivational message based on score
            let motivation = '';
            for (const range in MOTIVATIONAL_MESSAGES) {
                const [min, max] = range.split('-').map(Number);
                if (score >= min && score <= max) {
                    motivation = MOTIVATIONAL_MESSAGES[range];
                    break;
                }
            }
            
            // Format NIS and school name for certificate code
            const formattedNIS = participantData.studentId ? participantData.studentId : '0000';
            const formattedSchool = participantData.school ? participantData.school.replace(/\s+/g, '-').toUpperCase().substring(0, 10) : 'SEKOLAH';
            
            // Create certificate HTML
            const certificate = document.createElement('div');
            certificate.className = 'certificate';
            
            certificate.innerHTML = `
                <div class="certificate-content">
                    <h1 class="certificate-title">SERTIFIKAT PRESTASI</h1>
                    <p class="certificate-code">${formatName(participantData.fullname)}/${formattedNIS}/${formattedSchool}/${participantData.level || 'UMUM'}/${participantData.subject || 'UMUM'}/${dateString}/${certificateCode}/PERGUNU-STB</p>
                    <p>Diberikan Kepada</p>
                    <h2 class="certificate-recipient">${formatName(participantData.fullname)}</h2>
                    <p class="certificate-body">
                        Atas Partisipasi & Pencapaian Luar Biasa Dalam<br>
                        Ujian Bahasa Inggris Pergunu Situbondo
                    </p>
                    <p class="certificate-body">
                        Sebagai penghargaan atas dedikasi dalam memahami materi Bahasa Inggris dan meningkatkan kemampuan berbahasa, 
                        sertifikat ini diberikan sebagai motivasi untuk terus berkembang dalam pembelajaran bahasa asing.
                    </p>
                    <div class="certificate-score">Nilai: ${score}%</div>
                    <p class="certificate-motivation">${motivation}</p>
                    <div class="certificate-footer">
                        <p>Ditetapkan di: Situbondo, ${now.toLocaleDateString('id-ID', { day: 'numeric', month: 'long', year: 'numeric' })}</p>
                        <div class="certificate-signature">
                            <p>Ketua Pergunu Situbondo</p>
                            <p><strong>${adminSettings.chairmanName}</strong></p>
                        </div>
                        <img src="https://raw.githubusercontent.com/pergunu/ujian-online/main/assets/images/BARCODE.png" alt="Barcode" class="certificate-barcode">
                    </div>
                </div>
            `;
            
            certificateContainer.appendChild(certificate);
            certificateContainer.style.display = 'block';
        }
        
        function showCelebration() {
            // Show celebration particles
            document.getElementById('celebration-particles').style.display = 'block';
            
            // Hide after 5 seconds
            setTimeout(() => {
                document.getElementById('celebration-particles').style.display = 'none';
            }, 5000);
        }
        
        function formatName(name) {
            return name.split(' ').map(word => 
                word.charAt(0).toUpperCase() + word.slice(1).toLowerCase()
            ).join(' ');
        }
        
        function generateUniqueCode() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let result = '';
            
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            result += '-';
            
            for (let i = 0; i < 4; i++) {
                result += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            return result;
        }
        
        function printCertificate() {
            // Hide floating buttons
            document.querySelector('.floating-buttons').style.display = 'none';
            
            // Hide other elements in results screen
            document.querySelector('.results-summary').style.display = 'none';
            document.querySelector('.result-actions').style.display = 'none';
            
            // Print the certificate
            window.print();
            
            // Show elements again after printing
            setTimeout(() => {
                document.querySelector('.floating-buttons').style.display = 'flex';
                document.querySelector('.results-summary').style.display = 'block';
                document.querySelector('.result-actions').style.display = 'block';
            }, 500);
        }
        
        function retakeExam() {
            // Hide results screen with slide out animation
            document.getElementById('results-screen').classList.add('slide-out');
            
            // Show participant form after animation completes
            setTimeout(() => {
                document.getElementById('results-screen').style.display = 'none';
                document.getElementById('participant-form').style.display = 'block';
                document.getElementById('participant-form').classList.add('slide-in');
                currentScreen = 'participant';
                
                // Reset timer
                examTimeLeft = adminSettings.examDuration * 60;
            }, 500);
        }
        
        function contactAdmin() {
            const message = encodeURIComponent("Assalamualaikum mas admin, saya mau tanya sesuatu nih...");
            window.open(`https://wa.me/6285647709114?text=${message}`, '_blank');
        }
        
        function showAdminPanelModal() {
            document.getElementById('admin-panel-modal').style.display = 'flex';
        }
        
        function hideAdminPanelModal() {
            document.getElementById('admin-panel-modal').style.display = 'none';
        }
        
        function submitAdminPanelCode() {
            const code = document.getElementById('admin-panel-code').value;
            
            if (code === adminSettings.adminCode) {
                // Show admin panel content
                document.getElementById('admin-panel-content').style.display = 'block';
                // Load participants data
                loadParticipantsData();
            } else {
                alert('Kode admin salah. Silakan coba lagi.');
            }
        }

        function loadParticipantsData() {
            const tableBody = document.getElementById('participants-table-body');
            tableBody.innerHTML = '';
            
            if (participantsData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="10" style="text-align: center;">Belum ada data peserta</td></tr>';
                return;
            }
            
            // Sort by date (newest first)
            const sortedData = [...participantsData].sort((a, b) => 
                new Date(b.examDate) - new Date(a.examDate));
            
            sortedData.forEach((participant, index) => {
                const date = new Date(participant.examDate);
                const dateStr = date.toLocaleDateString('id-ID', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const row = document.createElement('tr');
                row.dataset.index = index;
                row.innerHTML = `
                    <td>
                        <input type="checkbox" class="select-checkbox" data-index="${index}" onchange="toggleParticipantSelection(${index})">
                    </td>
                    <td>${dateStr}</td>
                    <td>${participant.fullname}</td>
                    <td>${participant.studentId || '-'}</td>
                    <td>Pelajar</td>
                    <td>${participant.level || '-'}</td>
                    <td>${participant.grade ? `Kelas ${participant.grade}` : '-'}</td>
                    <td>${participant.subject || '-'}</td>
                    <td>${participant.score}%</td>
                    <td>${participant.certificateCode || '-'}</td>
                `;
                
                tableBody.appendChild(row);
            });
            
            // Reset selected participants
            selectedParticipants = [];
            updateParticipantActionButtons();
        }
        
        function toggleParticipantSelection(index) {
            const checkbox = document.querySelector(`.select-checkbox[data-index="${index}"]`);
            if (checkbox.checked) {
                if (!selectedParticipants.includes(index)) {
                    selectedParticipants.push(index);
                }
            } else {
                selectedParticipants = selectedParticipants.filter(i => i !== index);
            }
            
            // Update select all checkbox
            updateSelectAllCheckbox();
            
            // Update action buttons
            updateParticipantActionButtons();
        }
        
        function toggleSelectAllParticipants() {
            const selectAllCheckbox = document.getElementById('select-all-checkbox');
            const checkboxes = document.querySelectorAll('.select-checkbox');
            
            selectAllCheckbox.checked = !selectAllCheckbox.checked;
            const isChecked = selectAllCheckbox.checked;
            
            checkboxes.forEach(checkbox => {
                checkbox.checked = isChecked;
                const index = parseInt(checkbox.dataset.index);
                
                if (isChecked) {
                    if (!selectedParticipants.includes(index)) {
                        selectedParticipants.push(index);
                    }
                } else {
                    selectedParticipants = selectedParticipants.filter(i => i !== index);
                }
            });
            
            // Update action buttons
            updateParticipantActionButtons();
        }
        
        function updateSelectAllCheckbox() {
            const checkboxes = document.querySelectorAll('.select-checkbox');
            const selectAllCheckbox = document.getElementById('select-all-checkbox');
            
            if (checkboxes.length === 0) {
                selectAllCheckbox.checked = false;
                return;
            }
            
            const allChecked = Array.from(checkboxes).every(checkbox => checkbox.checked);
            selectAllCheckbox.checked = allChecked;
        }
        
        function updateParticipantActionButtons() {
            const hasSelection = selectedParticipants.length > 0;
            
            document.getElementById('edit-selected-participants').disabled = !hasSelection;
            document.getElementById('delete-selected-participants').disabled = !hasSelection;
        }
        
        function editSelectedParticipants() {
            if (selectedParticipants.length === 0) return;
            
            // For now, we'll just edit the first selected participant
            // In a real app, you might want to implement bulk editing
            const index = selectedParticipants[0];
            editParticipant(index);
        }
        
        function editParticipant(index) {
            const participant = participantsData[index];
            
            // Fill the edit form
            document.getElementById('edit-fullname').value = participant.fullname;
            
            // Set status to student (only option now)
            document.getElementById('edit-status-student').checked = true;
            document.getElementById('edit-student-fields').style.display = 'block';
            
            // Fill student fields
            document.getElementById('edit-school-name').value = participant.school || '';
            document.getElementById('edit-student-id').value = participant.studentId || '';
            
            // Set purpose
            if (participant.purpose) {
                const purposeRadio = document.querySelector(`input[name="edit-purpose"][value="${participant.purpose}"]`);
                if (purposeRadio) purposeRadio.checked = true;
            }
            
            // Set level
            if (participant.level) {
                const levelRadio = document.querySelector(`input[name="edit-level"][value="${participant.level}"]`);
                if (levelRadio) levelRadio.checked = true;
                
                // Show grade selection
                showEditGradeSelection();
                
                // Set grade
                if (participant.grade) {
                    const gradeRadio = document.querySelector(`input[name="edit-grade"][value="${participant.grade}"]`);
                    if (gradeRadio) gradeRadio.checked = true;
                }
            }
            
            // Set subject
            if (participant.subject) {
                document.getElementById('edit-subject').value = participant.subject;
            }
            
            // Set score
            document.getElementById('edit-score').value = participant.score;
            
            // Set certificate code
            document.getElementById('edit-certificate-code').value = participant.certificateCode || '-';
            
            // Store index for saving
            document.getElementById('edit-participant-index').value = index;
            
            // Show the modal
            document.getElementById('edit-participant-modal').style.display = 'flex';
        }
        
        function toggleEditParticipantFields() {
            // Only student status is available now
            document.getElementById('edit-student-fields').style.display = 'block';
        }
        
        function showEditGradeSelection() {
            const level = document.querySelector('input[name="edit-level"]:checked')?.value;
            const gradeOptions = document.getElementById('edit-grade-options');
            
            // Clear previous options
            gradeOptions.innerHTML = '';
            
            if (!level) return;
            
            // Add options based on level
            if (level === 'SD') {
                addEditGradeOption('edit-grade-4', 'Kelas <span class="roman">IV</span>', '4');
                addEditGradeOption('edit-grade-5', 'Kelas <span class="roman">V</span>', '5');
                addEditGradeOption('edit-grade-6', 'Kelas <span class="roman">VI</span>', '6');
            } else if (level === 'SMP') {
                addEditGradeOption('edit-grade-7', 'Kelas <span class="roman">VII</span>', '7');
                addEditGradeOption('edit-grade-8', 'Kelas <span class="roman">VIII</span>', '8');
                addEditGradeOption('edit-grade-9', 'Kelas <span class="roman">IX</span>', '9');
            } else if (level === 'SMA/SMK') {
                addEditGradeOption('edit-grade-10', 'Kelas <span class="roman">X</span>', '10');
                addEditGradeOption('edit-grade-11', 'Kelas <span class="roman">XI</span>', '11');
                addEditGradeOption('edit-grade-12', 'Kelas <span class="roman">XII</span>', '12');
            }
        }
        
        function addEditGradeOption(id, label, value) {
            const container = document.getElementById('edit-grade-options');
            
            const radio = document.createElement('input');
            radio.type = 'radio';
            radio.id = id;
            radio.name = 'edit-grade';
            radio.value = value;
            radio.className = 'radio-option';
            
            const radioLabel = document.createElement('label');
            radioLabel.htmlFor = id;
            radioLabel.className = 'radio-label';
            radioLabel.innerHTML = label;
            
            container.appendChild(radio);
            container.appendChild(radioLabel);
        }
        
        function saveEditedParticipant() {
            const index = document.getElementById('edit-participant-index').value;
            if (!index) return;
            
            const participant = participantsData[index];
            
            // Update participant data
            participant.fullname = document.getElementById('edit-fullname').value.trim();
            participant.status = 'pelajar';
            participant.school = document.getElementById('edit-school-name').value.trim();
            participant.studentId = document.getElementById('edit-student-id').value.trim();
            participant.purpose = document.querySelector('input[name="edit-purpose"]:checked')?.value || '';
            participant.level = document.querySelector('input[name="edit-level"]:checked')?.value || '';
            participant.grade = document.querySelector('input[name="edit-grade"]:checked')?.value || '';
            participant.subject = document.getElementById('edit-subject').value;
            participant.score = parseInt(document.getElementById('edit-score').value);
            
            // Save to localStorage
            saveParticipantsData();
            
            // Reload participants data
            loadParticipantsData();
            
            // Hide modal
            hideEditParticipantModal();
            
            alert('Perubahan data peserta berhasil disimpan!');
        }
        
        function hideEditParticipantModal() {
            document.getElementById('edit-participant-modal').style.display = 'none';
        }
        
        function deleteSelectedParticipants() {
            if (selectedParticipants.length === 0) return;
            
            if (!confirm(`Apakah Anda yakin ingin menghapus ${selectedParticipants.length} peserta terpilih?`)) {
                return;
            }
            
            // Sort in descending order to avoid index issues when deleting
            const sortedIndices = [...selectedParticipants].sort((a, b) => b - a);
            
            // Delete participants
            sortedIndices.forEach(index => {
                participantsData.splice(index, 1);
            });
            
            // Save to localStorage
            saveParticipantsData();
            
            // Reload participants data
            loadParticipantsData();
            
            alert(`${sortedIndices.length} peserta berhasil dihapus!`);
        }
        
        function searchParticipants() {
            const searchTerm = document.getElementById('participant-search').value.toLowerCase();
            const rows = document.querySelectorAll('#participants-table-body tr');
            
            rows.forEach(row => {
                const index = parseInt(row.dataset.index);
                const participant = participantsData[index];
                const rowText = `
                    ${participant.fullname.toLowerCase()} 
                    ${participant.studentId || ''} 
                    ${participant.certificateCode || ''}
                `;
                
                if (rowText.includes(searchTerm)) {
                    row.style.display = '';
                } else {
                    row.style.display = 'none';
                }
            });
        }
        
        function validateCertificate() {
            const code = document.getElementById('certificate-code-input').value.trim();
            const validationResult = document.getElementById('validation-result');
            
            if (!code) {
                alert('Silakan masukkan kode sertifikat');
                return;
            }
            
            // Find participant with this certificate code
            const participant = participantsData.find(p => p.certificateCode === code);
            
            if (participant) {
                validationResult.innerHTML = `
                    <p class="valid-certificate">Sertifikat Valid!</p>
                    <p>Nama: ${participant.fullname}</p>
                    <p>Status: Pelajar</p>
                    <p>Tingkat: ${participant.level || '-'}</p>
                    <p>Kelas: ${participant.grade ? `Kelas ${participant.grade}` : '-'}</p>
                    <p>Mata Ujian: ${participant.subject || '-'}</p>
                    <p>Nilai: ${participant.score}%</p>
                    <p>Tanggal Ujian: ${new Date(participant.examDate).toLocaleDateString('id-ID')}</p>
                    <p>Perangkat: ${participant.deviceInfo?.deviceType || 'Tidak diketahui'}</p>
                `;
                validationResult.style.display = 'block';
            } else {
                validationResult.innerHTML = '<p class="invalid-certificate">Sertifikat Tidak Valid!</p>';
                validationResult.style.display = 'block';
            }
        }
        
        function saveCodes() {
            const newLoginCode = document.getElementById('new-login-code').value;
            const newAdminCode = document.getElementById('new-admin-code').value;
            
            if (newLoginCode) {
                adminSettings.loginCode = newLoginCode;
                document.getElementById('new-login-code').value = '';
            }
            
            if (newAdminCode) {
                adminSettings.adminCode = newAdminCode;
                document.getElementById('new-admin-code').value = '';
            }
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Kode berhasil diubah!');
        }
        
        function saveContent() {
            const greetingMessage = document.getElementById('greeting-message-input').value;
            const adminMessage = document.getElementById('admin-message-input').value;
            const chairmanName = document.getElementById('chairman-name').value;
            
            // Update admin settings
            adminSettings.greetingMessage = greetingMessage;
            adminSettings.adminMessage = adminMessage;
            adminSettings.chairmanName = chairmanName;
            
            // Update UI
            document.getElementById('greeting-text').textContent = greetingMessage;
            document.getElementById('admin-message').textContent = adminMessage;
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Perubahan konten berhasil disimpan!');
        }
        
        function saveSettings() {
            const examDuration = parseInt(document.getElementById('exam-duration').value);
            
            // Update admin settings
            adminSettings.examDuration = examDuration;
            
            // Update subject toggle
            adminSettings.enabledSubjects = {
                "Bahasa Inggris": document.getElementById('toggle-english').checked
            };
            
            // Save to localStorage
            saveAdminSettings();
            
            alert('Pengaturan berhasil disimpan!');
        }
        
        function exportToCSV() {
            if (participantsData.length === 0) {
                alert('Tidak ada data peserta untuk diekspor');
                return;
            }
            
            // Create CSV header
            let csv = 'Nama,NIS,Sekolah,Tingkat,Kelas,Subject,Nilai,Kode Sertifikat,Tanggal Ujian,Jenis Perangkat\n';
            
            // Add data rows
            participantsData.forEach(participant => {
                csv += `"${participant.fullname}","${participant.studentId || ''}","${participant.school || ''}",`;
                csv += `"${participant.level || ''}","${participant.grade || ''}","${participant.subject || ''}",`;
                csv += `"${participant.score}","${participant.certificateCode || ''}","${new Date(participant.examDate).toLocaleString('id-ID')}",`;
                csv += `"${participant.deviceInfo?.deviceType || 'Tidak diketahui'}"\n`;
            });
            
            // Create download link
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `data-peserta-${new Date().toISOString().slice(0,10)}.csv`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function exportToJSON() {
            if (participantsData.length === 0) {
                alert('Tidak ada data peserta untuk diekspor');
                return;
            }
            
            // Create JSON data
            const jsonData = JSON.stringify(participantsData, null, 2);
            
            // Create download link
            const blob = new Blob([jsonData], { type: 'application/json;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.setAttribute('href', url);
            link.setAttribute('download', `data-peserta-${new Date().toISOString().slice(0,10)}.json`);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
        
        function exportToExcel() {
            if (participantsData.length === 0) {
                alert('Tidak ada data peserta untuk diekspor');
                return;
            }
            
            // Prepare data for Excel
            const excelData = [
                ['Nama', 'NIS', 'Sekolah', 'Tingkat', 'Kelas', 'Mata Ujian', 'Nilai', 'Kode Sertifikat', 'Tanggal Ujian', 'Jenis Perangkat']
            ];
            
            participantsData.forEach(participant => {
                excelData.push([
                    participant.fullname,
                    participant.studentId || '',
                    participant.school || '',
                    participant.level || '',
                    participant.grade || '',
                    participant.subject || '',
                    participant.score,
                    participant.certificateCode || '',
                    new Date(participant.examDate).toLocaleString('id-ID'),
                    participant.deviceInfo?.deviceType || 'Tidak diketahui'
                ]);
            });
            
            // Create worksheet
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            
            // Create workbook
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, "Data Peserta");
            
            // Export to Excel file
            XLSX.writeFile(wb, `data-peserta-${new Date().toISOString().slice(0,10)}.xlsx`);
        }
    </script>
</body>
</html>
